---
title: A Tidygraph version of a Popular Network Science Tutorial
author: Arvind Venkatadri
date: '2021-06-16'
slug: a-tidygraph-version-of-a-popular-network-science-tutorial
categories: [R; Networks]
tags: [tidygraph; ggraph;]
subtitle: ''
summary: 'A reworking of a Network Science tutorial by Prof. Katherine Ognyanova, using tidygraph'
authors: []
lastmod: '2021-06-16T17:29:47+05:30'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>
<script src="{{< blogdown/postref >}}index_files/htmlwidgets/htmlwidgets.js"></script>
<link href="{{< blogdown/postref >}}index_files/vis/vis.css" rel="stylesheet" />
<script src="{{< blogdown/postref >}}index_files/vis/vis.min.js"></script>
<script src="{{< blogdown/postref >}}index_files/visNetwork-binding/visNetwork.js"></script>
<link href="{{< blogdown/postref >}}index_files/font-awesome/css/font-awesome.min.css" rel="stylesheet" />


<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>This is an attempt to rework , using <code>tidygraph</code> and <code>ggraph</code>, much of <a href="https://www.kateto.net/polnet2018"><strong>Network Visualization with R</strong></a> Polnet 2018 Workshop Tutorial, Washington, DC by Prof. Katherine (Katya) Ognyanova.</p>
<p>The aim is to get a working acquaintance with both these packages and also to appreciate some of the concepts in Networks. My code is by no means intended to be elegant; it merely works and there are surely many improvements that people may think of!</p>
<p>I have attempted to write code for the Sections 2:5.</p>
<p>I have retained Prof. Ognyanova’s text in all places.</p>
</div>
<div id="contents" class="section level2">
<h2>CONTENTS</h2>
<ol style="list-style-type: decimal">
<li><del>Working with colors in R plots</del></li>
<li>Reading in the network data</li>
<li>Network plots in ‘igraph’</li>
<li>Plotting two-mode networks</li>
<li>Plotting multiplex networks</li>
<li><del>Quick example using ‘network’</del></li>
<li><del>Simple plot animations in R</del></li>
<li><del>Interactive JavaScript networks</del></li>
<li><del>Interactive and dynamic networks with ndtv-d3</del></li>
<li><del>Plotting networks on a geographic map</del></li>
</ol>
</div>
<div id="dataset-1-edgelist--" class="section level2">
<h2>——-~~ DATASET 1: edgelist ~~——-</h2>
<pre class="r"><code># Read in the data:
nodes &lt;- read.csv(&quot;./Dataset1-Media-Example-NODES.csv&quot;, header = T, as.is = T)
links &lt;- read.csv(&quot;./Dataset1-Media-Example-EDGES.csv&quot;, header = T, as.is = T)</code></pre>
<pre class="r"><code># Examine the data:
head(nodes)</code></pre>
<pre><code>##    id               media media.type type.label audience.size
## 1 s01            NY Times          1  Newspaper            20
## 2 s02     Washington Post          1  Newspaper            25
## 3 s03 Wall Street Journal          1  Newspaper            30
## 4 s04           USA Today          1  Newspaper            32
## 5 s05            LA Times          1  Newspaper            20
## 6 s06       New York Post          1  Newspaper            50</code></pre>
<pre class="r"><code>head(links)</code></pre>
<pre><code>##   from  to      type weight
## 1  s01 s02 hyperlink     22
## 2  s01 s03 hyperlink     22
## 3  s01 s04 hyperlink     21
## 4  s01 s15   mention     20
## 5  s02 s01 hyperlink     23
## 6  s02 s03 hyperlink     21</code></pre>
<div id="converting-the-data-to-an-igraph-object" class="section level3">
<h3>Converting the data to an igraph object:</h3>
<p>The <code>graph_from_data_frame()</code> function takes two data frames: ‘d’ and ‘vertices’.
- ‘d’ describes the edges of the network - it should start with two columns containing the source and target node IDs for each network tie.
- ‘vertices’ should start with a column of node IDs. It can be omitted.
- Any additional columns in either data frame are interpreted as attributes.</p>
<p>NOTE: ID columns need not be numbers or integers!!</p>
<pre class="r"><code>net &lt;- graph_from_data_frame(d = links, vertices = nodes, directed = T)

# Examine the resulting object:
class(net)</code></pre>
<pre><code>## [1] &quot;igraph&quot;</code></pre>
<pre class="r"><code>net</code></pre>
<pre><code>## IGRAPH b658a68 DNW- 17 49 -- 
## + attr: name (v/c), media (v/c), media.type (v/n), type.label (v/c),
## | audience.size (v/n), type (e/c), weight (e/n)
## + edges from b658a68 (vertex names):
##  [1] s01-&gt;s02 s01-&gt;s03 s01-&gt;s04 s01-&gt;s15 s02-&gt;s01 s02-&gt;s03 s02-&gt;s09 s02-&gt;s10
##  [9] s03-&gt;s01 s03-&gt;s04 s03-&gt;s05 s03-&gt;s08 s03-&gt;s10 s03-&gt;s11 s03-&gt;s12 s04-&gt;s03
## [17] s04-&gt;s06 s04-&gt;s11 s04-&gt;s12 s04-&gt;s17 s05-&gt;s01 s05-&gt;s02 s05-&gt;s09 s05-&gt;s15
## [25] s06-&gt;s06 s06-&gt;s16 s06-&gt;s17 s07-&gt;s03 s07-&gt;s08 s07-&gt;s10 s07-&gt;s14 s08-&gt;s03
## [33] s08-&gt;s07 s08-&gt;s09 s09-&gt;s10 s10-&gt;s03 s12-&gt;s06 s12-&gt;s13 s12-&gt;s14 s13-&gt;s12
## [41] s13-&gt;s17 s14-&gt;s11 s14-&gt;s13 s15-&gt;s01 s15-&gt;s04 s15-&gt;s06 s16-&gt;s06 s16-&gt;s17
## [49] s17-&gt;s04</code></pre>
<p>The description of an igraph object starts with four letters:
-D or U, for a directed or undirected graph
-N for a named graph (where nodes have a <code>name</code> attribute)
-W for a weighted graph (where edges have a <code>weight</code> attribute)
-B for a bipartite (two-mode) graph (where nodes have a <code>type</code> attribute)
The two numbers that follow (17 49) refer to the <strong>number of nodes</strong> and <strong>edges</strong> in the graph. The description also lists node &amp; edge attributes.</p>
<p>We can access the nodes, edges, and their attributes:</p>
<pre class="r"><code>E(net)</code></pre>
<pre><code>## + 49/49 edges from b658a68 (vertex names):
##  [1] s01-&gt;s02 s01-&gt;s03 s01-&gt;s04 s01-&gt;s15 s02-&gt;s01 s02-&gt;s03 s02-&gt;s09 s02-&gt;s10
##  [9] s03-&gt;s01 s03-&gt;s04 s03-&gt;s05 s03-&gt;s08 s03-&gt;s10 s03-&gt;s11 s03-&gt;s12 s04-&gt;s03
## [17] s04-&gt;s06 s04-&gt;s11 s04-&gt;s12 s04-&gt;s17 s05-&gt;s01 s05-&gt;s02 s05-&gt;s09 s05-&gt;s15
## [25] s06-&gt;s06 s06-&gt;s16 s06-&gt;s17 s07-&gt;s03 s07-&gt;s08 s07-&gt;s10 s07-&gt;s14 s08-&gt;s03
## [33] s08-&gt;s07 s08-&gt;s09 s09-&gt;s10 s10-&gt;s03 s12-&gt;s06 s12-&gt;s13 s12-&gt;s14 s13-&gt;s12
## [41] s13-&gt;s17 s14-&gt;s11 s14-&gt;s13 s15-&gt;s01 s15-&gt;s04 s15-&gt;s06 s16-&gt;s06 s16-&gt;s17
## [49] s17-&gt;s04</code></pre>
<pre class="r"><code>V(net)</code></pre>
<pre><code>## + 17/17 vertices, named, from b658a68:
##  [1] s01 s02 s03 s04 s05 s06 s07 s08 s09 s10 s11 s12 s13 s14 s15 s16 s17</code></pre>
<pre class="r"><code>E(net)$type</code></pre>
<pre><code>##  [1] &quot;hyperlink&quot; &quot;hyperlink&quot; &quot;hyperlink&quot; &quot;mention&quot;   &quot;hyperlink&quot; &quot;hyperlink&quot;
##  [7] &quot;hyperlink&quot; &quot;hyperlink&quot; &quot;hyperlink&quot; &quot;hyperlink&quot; &quot;hyperlink&quot; &quot;hyperlink&quot;
## [13] &quot;mention&quot;   &quot;hyperlink&quot; &quot;hyperlink&quot; &quot;hyperlink&quot; &quot;mention&quot;   &quot;mention&quot;  
## [19] &quot;hyperlink&quot; &quot;mention&quot;   &quot;mention&quot;   &quot;hyperlink&quot; &quot;hyperlink&quot; &quot;mention&quot;  
## [25] &quot;hyperlink&quot; &quot;hyperlink&quot; &quot;mention&quot;   &quot;mention&quot;   &quot;mention&quot;   &quot;hyperlink&quot;
## [31] &quot;mention&quot;   &quot;hyperlink&quot; &quot;mention&quot;   &quot;mention&quot;   &quot;mention&quot;   &quot;hyperlink&quot;
## [37] &quot;mention&quot;   &quot;hyperlink&quot; &quot;mention&quot;   &quot;hyperlink&quot; &quot;mention&quot;   &quot;mention&quot;  
## [43] &quot;mention&quot;   &quot;hyperlink&quot; &quot;hyperlink&quot; &quot;hyperlink&quot; &quot;hyperlink&quot; &quot;mention&quot;  
## [49] &quot;hyperlink&quot;</code></pre>
<pre class="r"><code>V(net)$media</code></pre>
<pre><code>##  [1] &quot;NY Times&quot;            &quot;Washington Post&quot;     &quot;Wall Street Journal&quot;
##  [4] &quot;USA Today&quot;           &quot;LA Times&quot;            &quot;New York Post&quot;      
##  [7] &quot;CNN&quot;                 &quot;MSNBC&quot;               &quot;FOX News&quot;           
## [10] &quot;ABC&quot;                 &quot;BBC&quot;                 &quot;Yahoo News&quot;         
## [13] &quot;Google News&quot;         &quot;Reuters.com&quot;         &quot;NYTimes.com&quot;        
## [16] &quot;WashingtonPost.com&quot;  &quot;AOL.com&quot;</code></pre>
<pre class="r"><code># Using tidygraph
tbl_graph(nodes, links, directed = TRUE) %&gt;% 
  activate(edges) %&gt;% 
  select(type)</code></pre>
<pre><code>## # A tbl_graph: 17 nodes and 49 edges
## #
## # A directed multigraph with 1 component
## #
## # Edge Data: 49 x 3 (active)
##    from    to type     
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;    
## 1     1     2 hyperlink
## 2     1     3 hyperlink
## 3     1     4 hyperlink
## 4     1    15 mention  
## 5     2     1 hyperlink
## 6     2     3 hyperlink
## # ... with 43 more rows
## #
## # Node Data: 17 x 5
##   id    media               media.type type.label audience.size
##   &lt;chr&gt; &lt;chr&gt;                    &lt;int&gt; &lt;chr&gt;              &lt;int&gt;
## 1 s01   NY Times                     1 Newspaper             20
## 2 s02   Washington Post              1 Newspaper             25
## 3 s03   Wall Street Journal          1 Newspaper             30
## # ... with 14 more rows</code></pre>
<pre class="r"><code>tbl_graph(nodes, links, directed = TRUE) %&gt;% 
  activate(nodes) %&gt;% 
  select(media)</code></pre>
<pre><code>## # A tbl_graph: 17 nodes and 49 edges
## #
## # A directed multigraph with 1 component
## #
## # Node Data: 17 x 1 (active)
##   media              
##   &lt;chr&gt;              
## 1 NY Times           
## 2 Washington Post    
## 3 Wall Street Journal
## 4 USA Today          
## 5 LA Times           
## 6 New York Post      
## # ... with 11 more rows
## #
## # Edge Data: 49 x 4
##    from    to type      weight
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;int&gt;
## 1     1     2 hyperlink     22
## 2     1     3 hyperlink     22
## 3     1     4 hyperlink     21
## # ... with 46 more rows</code></pre>
<p>Or find specific nodes and edges by attribute:(that returns objects of type vertex sequence / edge sequence)</p>
<pre class="r"><code>V(net)[media == &quot;BBC&quot;]</code></pre>
<pre><code>## + 1/17 vertex, named, from b658a68:
## [1] s11</code></pre>
<pre class="r"><code>E(net)[type == &quot;mention&quot;]</code></pre>
<pre><code>## + 20/49 edges from b658a68 (vertex names):
##  [1] s01-&gt;s15 s03-&gt;s10 s04-&gt;s06 s04-&gt;s11 s04-&gt;s17 s05-&gt;s01 s05-&gt;s15 s06-&gt;s17
##  [9] s07-&gt;s03 s07-&gt;s08 s07-&gt;s14 s08-&gt;s07 s08-&gt;s09 s09-&gt;s10 s12-&gt;s06 s12-&gt;s14
## [17] s13-&gt;s17 s14-&gt;s11 s14-&gt;s13 s16-&gt;s17</code></pre>
<pre class="r"><code>#Using tidygraph
tbl_graph(nodes, links, directed = TRUE) %&gt;% 
  activate(nodes) %&gt;% 
  filter(media == &quot;BBC&quot;)</code></pre>
<pre><code>## # A tbl_graph: 1 nodes and 0 edges
## #
## # A rooted tree
## #
## # Node Data: 1 x 5 (active)
##   id    media media.type type.label audience.size
##   &lt;chr&gt; &lt;chr&gt;      &lt;int&gt; &lt;chr&gt;              &lt;int&gt;
## 1 s11   BBC            2 TV                    34
## #
## # Edge Data: 0 x 4
## # ... with 4 variables: from &lt;int&gt;, to &lt;int&gt;, type &lt;chr&gt;, weight &lt;int&gt;</code></pre>
<pre class="r"><code>tbl_graph(nodes, links, directed = TRUE) %&gt;% 
  activate(edges) %&gt;% 
  filter(type == &quot;mention&quot;)</code></pre>
<pre><code>## # A tbl_graph: 17 nodes and 20 edges
## #
## # A directed simple graph with 3 components
## #
## # Edge Data: 20 x 4 (active)
##    from    to type    weight
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;int&gt;
## 1     1    15 mention     20
## 2     3    10 mention      2
## 3     4     6 mention      1
## 4     4    11 mention     22
## 5     4    17 mention      2
## 6     5     1 mention      1
## # ... with 14 more rows
## #
## # Node Data: 17 x 5
##   id    media               media.type type.label audience.size
##   &lt;chr&gt; &lt;chr&gt;                    &lt;int&gt; &lt;chr&gt;              &lt;int&gt;
## 1 s01   NY Times                     1 Newspaper             20
## 2 s02   Washington Post              1 Newspaper             25
## 3 s03   Wall Street Journal          1 Newspaper             30
## # ... with 14 more rows</code></pre>
<p>If you need them, you can extract an edge list or a matrix back from the igraph networks.</p>
<pre class="r"><code>as_edgelist(net, names = T)</code></pre>
<pre><code>##       [,1]  [,2] 
##  [1,] &quot;s01&quot; &quot;s02&quot;
##  [2,] &quot;s01&quot; &quot;s03&quot;
##  [3,] &quot;s01&quot; &quot;s04&quot;
##  [4,] &quot;s01&quot; &quot;s15&quot;
##  [5,] &quot;s02&quot; &quot;s01&quot;
##  [6,] &quot;s02&quot; &quot;s03&quot;
##  [7,] &quot;s02&quot; &quot;s09&quot;
##  [8,] &quot;s02&quot; &quot;s10&quot;
##  [9,] &quot;s03&quot; &quot;s01&quot;
## [10,] &quot;s03&quot; &quot;s04&quot;
## [11,] &quot;s03&quot; &quot;s05&quot;
## [12,] &quot;s03&quot; &quot;s08&quot;
## [13,] &quot;s03&quot; &quot;s10&quot;
## [14,] &quot;s03&quot; &quot;s11&quot;
## [15,] &quot;s03&quot; &quot;s12&quot;
## [16,] &quot;s04&quot; &quot;s03&quot;
## [17,] &quot;s04&quot; &quot;s06&quot;
## [18,] &quot;s04&quot; &quot;s11&quot;
## [19,] &quot;s04&quot; &quot;s12&quot;
## [20,] &quot;s04&quot; &quot;s17&quot;
## [21,] &quot;s05&quot; &quot;s01&quot;
## [22,] &quot;s05&quot; &quot;s02&quot;
## [23,] &quot;s05&quot; &quot;s09&quot;
## [24,] &quot;s05&quot; &quot;s15&quot;
## [25,] &quot;s06&quot; &quot;s06&quot;
## [26,] &quot;s06&quot; &quot;s16&quot;
## [27,] &quot;s06&quot; &quot;s17&quot;
## [28,] &quot;s07&quot; &quot;s03&quot;
## [29,] &quot;s07&quot; &quot;s08&quot;
## [30,] &quot;s07&quot; &quot;s10&quot;
## [31,] &quot;s07&quot; &quot;s14&quot;
## [32,] &quot;s08&quot; &quot;s03&quot;
## [33,] &quot;s08&quot; &quot;s07&quot;
## [34,] &quot;s08&quot; &quot;s09&quot;
## [35,] &quot;s09&quot; &quot;s10&quot;
## [36,] &quot;s10&quot; &quot;s03&quot;
## [37,] &quot;s12&quot; &quot;s06&quot;
## [38,] &quot;s12&quot; &quot;s13&quot;
## [39,] &quot;s12&quot; &quot;s14&quot;
## [40,] &quot;s13&quot; &quot;s12&quot;
## [41,] &quot;s13&quot; &quot;s17&quot;
## [42,] &quot;s14&quot; &quot;s11&quot;
## [43,] &quot;s14&quot; &quot;s13&quot;
## [44,] &quot;s15&quot; &quot;s01&quot;
## [45,] &quot;s15&quot; &quot;s04&quot;
## [46,] &quot;s15&quot; &quot;s06&quot;
## [47,] &quot;s16&quot; &quot;s06&quot;
## [48,] &quot;s16&quot; &quot;s17&quot;
## [49,] &quot;s17&quot; &quot;s04&quot;</code></pre>
<pre class="r"><code>as_adjacency_matrix(net, attr = &quot;weight&quot;)</code></pre>
<pre><code>## 17 x 17 sparse Matrix of class &quot;dgCMatrix&quot;</code></pre>
<pre><code>##    [[ suppressing 17 column names &#39;s01&#39;, &#39;s02&#39;, &#39;s03&#39; ... ]]</code></pre>
<pre><code>##                                                      
## s01  . 22 22 21 .  .  .  .  .  .  .  .  .  . 20  .  .
## s02 23  . 21  . .  .  .  .  1  5  .  .  .  .  .  .  .
## s03 21  .  . 22 1  .  .  4  .  2  1  1  .  .  .  .  .
## s04  .  . 23  . .  1  .  .  .  . 22  3  .  .  .  .  2
## s05  1 21  .  . .  .  .  .  2  .  .  .  .  . 21  .  .
## s06  .  .  .  . .  1  .  .  .  .  .  .  .  .  . 21 21
## s07  .  .  1  . .  .  . 22  . 21  .  .  .  4  .  .  .
## s08  .  .  2  . .  . 21  . 23  .  .  .  .  .  .  .  .
## s09  .  .  .  . .  .  .  .  . 21  .  .  .  .  .  .  .
## s10  .  .  2  . .  .  .  .  .  .  .  .  .  .  .  .  .
## s11  .  .  .  . .  .  .  .  .  .  .  .  .  .  .  .  .
## s12  .  .  .  . .  2  .  .  .  .  .  . 22 22  .  .  .
## s13  .  .  .  . .  .  .  .  .  .  . 21  .  .  .  .  1
## s14  .  .  .  . .  .  .  .  .  .  1  . 21  .  .  .  .
## s15 22  .  .  1 .  4  .  .  .  .  .  .  .  .  .  .  .
## s16  .  .  .  . . 23  .  .  .  .  .  .  .  .  .  . 21
## s17  .  .  .  4 .  .  .  .  .  .  .  .  .  .  .  .  .</code></pre>
<pre class="r"><code># Using tidygraph
# No direct command seems available ...</code></pre>
<pre class="r"><code># Or data frames describing nodes and edges:
igraph::as_data_frame(x = net, what = &quot;edges&quot;)</code></pre>
<pre><code>##    from  to      type weight
## 1   s01 s02 hyperlink     22
## 2   s01 s03 hyperlink     22
## 3   s01 s04 hyperlink     21
## 4   s01 s15   mention     20
## 5   s02 s01 hyperlink     23
## 6   s02 s03 hyperlink     21
## 7   s02 s09 hyperlink      1
## 8   s02 s10 hyperlink      5
## 9   s03 s01 hyperlink     21
## 10  s03 s04 hyperlink     22
## 11  s03 s05 hyperlink      1
## 12  s03 s08 hyperlink      4
## 13  s03 s10   mention      2
## 14  s03 s11 hyperlink      1
## 15  s03 s12 hyperlink      1
## 16  s04 s03 hyperlink     23
## 17  s04 s06   mention      1
## 18  s04 s11   mention     22
## 19  s04 s12 hyperlink      3
## 20  s04 s17   mention      2
## 21  s05 s01   mention      1
## 22  s05 s02 hyperlink     21
## 23  s05 s09 hyperlink      2
## 24  s05 s15   mention     21
## 25  s06 s06 hyperlink      1
## 26  s06 s16 hyperlink     21
## 27  s06 s17   mention     21
## 28  s07 s03   mention      1
## 29  s07 s08   mention     22
## 30  s07 s10 hyperlink     21
## 31  s07 s14   mention      4
## 32  s08 s03 hyperlink      2
## 33  s08 s07   mention     21
## 34  s08 s09   mention     23
## 35  s09 s10   mention     21
## 36  s10 s03 hyperlink      2
## 37  s12 s06   mention      2
## 38  s12 s13 hyperlink     22
## 39  s12 s14   mention     22
## 40  s13 s12 hyperlink     21
## 41  s13 s17   mention      1
## 42  s14 s11   mention      1
## 43  s14 s13   mention     21
## 44  s15 s01 hyperlink     22
## 45  s15 s04 hyperlink      1
## 46  s15 s06 hyperlink      4
## 47  s16 s06 hyperlink     23
## 48  s16 s17   mention     21
## 49  s17 s04 hyperlink      4</code></pre>
<pre class="r"><code>igraph::as_data_frame(x = net, what = &quot;vertices&quot;)</code></pre>
<pre><code>##     name               media media.type type.label audience.size
## s01  s01            NY Times          1  Newspaper            20
## s02  s02     Washington Post          1  Newspaper            25
## s03  s03 Wall Street Journal          1  Newspaper            30
## s04  s04           USA Today          1  Newspaper            32
## s05  s05            LA Times          1  Newspaper            20
## s06  s06       New York Post          1  Newspaper            50
## s07  s07                 CNN          2         TV            56
## s08  s08               MSNBC          2         TV            34
## s09  s09            FOX News          2         TV            60
## s10  s10                 ABC          2         TV            23
## s11  s11                 BBC          2         TV            34
## s12  s12          Yahoo News          3     Online            33
## s13  s13         Google News          3     Online            23
## s14  s14         Reuters.com          3     Online            12
## s15  s15         NYTimes.com          3     Online            24
## s16  s16  WashingtonPost.com          3     Online            28
## s17  s17             AOL.com          3     Online            33</code></pre>
<pre class="r"><code>#Using tidygraph
tbl_graph(nodes, links, directed = TRUE) %&gt;% 
  activate(nodes) %&gt;% 
  as_tibble()</code></pre>
<pre><code>## # A tibble: 17 x 5
##    id    media               media.type type.label audience.size
##    &lt;chr&gt; &lt;chr&gt;                    &lt;int&gt; &lt;chr&gt;              &lt;int&gt;
##  1 s01   NY Times                     1 Newspaper             20
##  2 s02   Washington Post              1 Newspaper             25
##  3 s03   Wall Street Journal          1 Newspaper             30
##  4 s04   USA Today                    1 Newspaper             32
##  5 s05   LA Times                     1 Newspaper             20
##  6 s06   New York Post                1 Newspaper             50
##  7 s07   CNN                          2 TV                    56
##  8 s08   MSNBC                        2 TV                    34
##  9 s09   FOX News                     2 TV                    60
## 10 s10   ABC                          2 TV                    23
## 11 s11   BBC                          2 TV                    34
## 12 s12   Yahoo News                   3 Online                33
## 13 s13   Google News                  3 Online                23
## 14 s14   Reuters.com                  3 Online                12
## 15 s15   NYTimes.com                  3 Online                24
## 16 s16   WashingtonPost.com           3 Online                28
## 17 s17   AOL.com                      3 Online                33</code></pre>
<pre class="r"><code>tbl_graph(nodes, links, directed = TRUE)%&gt;% 
  activate(edges) %&gt;% 
  as_tibble()</code></pre>
<pre><code>## # A tibble: 49 x 4
##     from    to type      weight
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;int&gt;
##  1     1     2 hyperlink     22
##  2     1     3 hyperlink     22
##  3     1     4 hyperlink     21
##  4     1    15 mention       20
##  5     2     1 hyperlink     23
##  6     2     3 hyperlink     21
##  7     2     9 hyperlink      1
##  8     2    10 hyperlink      5
##  9     3     1 hyperlink     21
## 10     3     4 hyperlink     22
## # ... with 39 more rows</code></pre>
<pre class="r"><code># You can also access the network matrix directly:
net[1,]</code></pre>
<pre><code>## s01 s02 s03 s04 s05 s06 s07 s08 s09 s10 s11 s12 s13 s14 s15 s16 s17 
##   0  22  22  21   0   0   0   0   0   0   0   0   0   0  20   0   0</code></pre>
<pre class="r"><code>net[5,7]</code></pre>
<pre><code>## [1] 0</code></pre>
<pre class="r"><code># Using tidygraph
# Does not seem possible, even with `as.matrix()`.
# Returns tibbles only as in the code chunk above</code></pre>
<pre class="r"><code># First attempt to plot the graph:
plot(net) # not pretty!</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="r"><code># Removing loops from the graph:
net &lt;-
  igraph::simplify(net, remove.multiple = F, remove.loops = T)

# Let&#39;s and reduce the arrow size and remove the labels:
plot(net, edge.arrow.size = .4, vertex.label = NA)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
<pre class="r"><code># Using tidygraph
tbl_graph(nodes, links, directed = TRUE) %&gt;%
  ggraph(., layout = &quot;graphopt&quot;) +
  geom_edge_link(
    color = &quot;grey&quot;,
    end_cap = circle(0.2, &quot;cm&quot;),
    start_cap = circle(0.2, &quot;cm&quot;),
    # clears an area near the node
    
    arrow = arrow(
      type = &quot;closed&quot;,
      ends = &quot;last&quot;,
      length = unit(3, &quot;mm&quot;)
    )
  ) +
  geom_node_point(size = 6, shape = 21, fill = &quot;orange&quot;) +
  geom_node_text(aes(label = id))</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<pre class="r"><code># Removing loops from the graph:
# From the docs:
# convert() is a shorthand for performing both `morph` and `crystallise` along with extracting a single tbl_graph (defaults to the first). For morphs w(h)ere you know they only create a single graph, and you want to keep it, this is an easy way.
#
tbl_graph(nodes, links, directed = TRUE) %&gt;%

  convert(to_simple) %&gt;%
  ggraph(., layout = &quot;graphopt&quot;) +
  geom_edge_link(
    color = &quot;grey&quot;,
    end_cap = circle(0.2, &quot;cm&quot;),
    start_cap = circle(0.2, &quot;cm&quot;),
 
    arrow = arrow(
      type = &quot;closed&quot;,
      ends = &quot;last&quot;,
      length = unit(3, &quot;mm&quot;)
    )
  ) +
  geom_node_point(size = 6, shape = 21, fill = &quot;orange&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
</div>
<div id="dataset-2-matrix" class="section level2">
<h2>——-~~ DATASET 2: matrix ——–</h2>
<pre class="r"><code># Read in the data:
nodes2 &lt;- read.csv(&quot;./Dataset2-Media-User-Example-NODES.csv&quot;, header = T, as.is = T)
links2 &lt;- read.csv(&quot;./Dataset2-Media-User-Example-EDGES.csv&quot;, header = T, row.names = 1)

# Examine the data:
head(nodes2)</code></pre>
<pre><code>##    id   media media.type media.name audience.size
## 1 s01     NYT          1  Newspaper            20
## 2 s02    WaPo          1  Newspaper            25
## 3 s03     WSJ          1  Newspaper            30
## 4 s04    USAT          1  Newspaper            32
## 5 s05 LATimes          1  Newspaper            20
## 6 s06     CNN          2         TV            56</code></pre>
<pre class="r"><code>head(links2)</code></pre>
<pre><code>##     U01 U02 U03 U04 U05 U06 U07 U08 U09 U10 U11 U12 U13 U14 U15 U16 U17 U18 U19
## s01   1   1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
## s02   0   0   0   1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0
## s03   0   0   0   0   0   1   1   1   1   0   0   0   0   0   0   0   0   0   0
## s04   0   0   0   0   0   0   0   0   1   1   1   0   0   0   0   0   0   0   0
## s05   0   0   0   0   0   0   0   0   0   0   1   1   1   0   0   0   0   0   0
## s06   0   0   0   0   0   0   0   0   0   0   0   0   1   1   0   0   1   0   0
##     U20
## s01   0
## s02   1
## s03   0
## s04   0
## s05   0
## s06   0</code></pre>
<pre class="r"><code># links2 is a matrix for a two-mode network:
links2 &lt;- as.matrix(links2)
dim(links2)</code></pre>
<pre><code>## [1] 10 20</code></pre>
<pre class="r"><code>dim(nodes2)</code></pre>
<pre><code>## [1] 30  5</code></pre>
<p>Note: What is a <strong>two-mode</strong> network? A network that as a <code>node$type</code> variable and can be a <code>bipartite</code> or a <code>k-partite</code> network as a result.</p>
<pre class="r"><code># Create an igraph network object from the two-mode matrix:
net2 &lt;- igraph::graph_from_incidence_matrix(links2)

# To transform a one-mode network matrix into an igraph object,
# we would use graph_from_adjacency_matrix()

# A built-in vertex attribute &#39;type&#39; shows which mode vertices belong to.
table(V(net2)$type)</code></pre>
<pre><code>## 
## FALSE  TRUE 
##    10    20</code></pre>
<pre class="r"><code># Basic igraph plot
plot(net2,vertex.label = NA)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre class="r"><code># using tidygraph
# For all objects that are not node and edge data_frames
# tidygraph uses `as_tbl_graph()`
# 
graph &lt;- as_tbl_graph(links2)
graph %&gt;% activate(nodes) %&gt;% as_tibble()</code></pre>
<pre><code>## # A tibble: 30 x 2
##    type  name 
##    &lt;lgl&gt; &lt;chr&gt;
##  1 FALSE s01  
##  2 FALSE s02  
##  3 FALSE s03  
##  4 FALSE s04  
##  5 FALSE s05  
##  6 FALSE s06  
##  7 FALSE s07  
##  8 FALSE s08  
##  9 FALSE s09  
## 10 FALSE s10  
## # ... with 20 more rows</code></pre>
<pre class="r"><code>graph %&gt;% activate(edges) %&gt;% as_tibble()</code></pre>
<pre><code>## # A tibble: 31 x 3
##     from    to weight
##    &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;
##  1     1    11      1
##  2     1    12      1
##  3     1    13      1
##  4     2    14      1
##  5     2    15      1
##  6     2    30      1
##  7     3    16      1
##  8     3    17      1
##  9     3    18      1
## 10     3    19      1
## # ... with 21 more rows</code></pre>
<pre class="r"><code>graph %&gt;% 
  ggraph(., layout = &quot;graphopt&quot;) + 
  geom_edge_link(color = &quot;grey&quot;) + 
  geom_node_point(fill = &quot;orange&quot;, 
                  shape = 21, size = 6, 
                  color = &quot;black&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r"><code># Examine the resulting object:
class(net2)</code></pre>
<pre><code>## [1] &quot;igraph&quot;</code></pre>
<pre class="r"><code>net2</code></pre>
<pre><code>## IGRAPH b85369e UN-B 30 31 -- 
## + attr: type (v/l), name (v/c)
## + edges from b85369e (vertex names):
##  [1] s01--U01 s01--U02 s01--U03 s02--U04 s02--U05 s02--U20 s03--U06 s03--U07
##  [9] s03--U08 s03--U09 s04--U09 s04--U10 s04--U11 s05--U11 s05--U12 s05--U13
## [17] s06--U13 s06--U14 s06--U17 s07--U14 s07--U15 s07--U16 s08--U16 s08--U17
## [25] s08--U18 s08--U19 s09--U06 s09--U19 s09--U20 s10--U01 s10--U11</code></pre>
<p>Note: The remaining attributes for the nodes ( in data frame <code>nodes2</code>) are not (yet) a part of the graph, either with igraph or with tidygraph.</p>
</div>
<div id="network-plots-in-igraph" class="section level1">
<h1>3. Network plots in ‘igraph’</h1>
<div id="plot-parameters-in-igraph" class="section level2">
<h2>——~~ Plot parameters in igraph ——–</h2>
<p>Check out the node options (starting with ‘vertex.’) and the edge options (starting with ‘edge.’).</p>
<pre class="r"><code>?igraph.plotting</code></pre>
<pre><code>## starting httpd help server ... done</code></pre>
<p>We can set the node &amp; edge options in two ways - one is to specify them in the <code>plot()</code> function, as we are doing below.</p>
<ul>
<li>Plot with curved edges (edge.curved = .1) and reduce arrow size:</li>
</ul>
<pre class="r"><code>plot(net, edge.arrow.size = .4, edge.curved = .1)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<pre class="r"><code># Using tidygraph
graph &lt;- tbl_graph(nodes, links, directed = TRUE)
graph</code></pre>
<pre><code>## # A tbl_graph: 17 nodes and 49 edges
## #
## # A directed multigraph with 1 component
## #
## # Node Data: 17 x 5 (active)
##   id    media               media.type type.label audience.size
##   &lt;chr&gt; &lt;chr&gt;                    &lt;int&gt; &lt;chr&gt;              &lt;int&gt;
## 1 s01   NY Times                     1 Newspaper             20
## 2 s02   Washington Post              1 Newspaper             25
## 3 s03   Wall Street Journal          1 Newspaper             30
## 4 s04   USA Today                    1 Newspaper             32
## 5 s05   LA Times                     1 Newspaper             20
## 6 s06   New York Post                1 Newspaper             50
## # ... with 11 more rows
## #
## # Edge Data: 49 x 4
##    from    to type      weight
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;int&gt;
## 1     1     2 hyperlink     22
## 2     1     3 hyperlink     22
## 3     1     4 hyperlink     21
## # ... with 46 more rows</code></pre>
<pre class="r"><code>graph %&gt;% ggraph(., layout = &quot;graphopt&quot;) +
  geom_edge_arc(
    color = &quot;grey&quot;,
    strength = 0.1,
    end_cap = circle(.2, &quot;cm&quot;),

    arrow = arrow(
      type = &quot;closed&quot;,
      ends = &quot;both&quot;,
      length = unit(3, &quot;mm&quot;)
    )
  ) +
  geom_node_point(
    fill = &quot;orange&quot;,
    shape = 21,
    size = 8,
    color = &quot;black&quot;
  ) +
  geom_node_text(aes(label = id))</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-18-2.png" width="672" /></p>
<ul>
<li>Set node color to orange and the border color to hex 555555</li>
<li>Replace the vertex label with the node names stored in “media”</li>
</ul>
<pre class="r"><code>plot(
  net,
  edge.arrow.size = .2,
  edge.curved = 0,
  vertex.color = &quot;orange&quot;,
  vertex.frame.color = &quot;#555555&quot;,
  vertex.label = V(net)$media,
  vertex.label.color = &quot;black&quot;,
  vertex.label.cex = .7
)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<pre class="r"><code># Using tidygraph
#graph &lt;- tbl_graph(nodes, links, directed = TRUE)
#graph
graph %&gt;%
  ggraph(., layout = &quot;gem&quot;) +
  geom_edge_link(
    color = &quot;grey&quot;,
    end_cap = circle(.3, &quot;cm&quot;),
    
    arrow = arrow(
      type = &quot;closed&quot;,
      ends = &quot;both&quot;,
      length = unit(1, &quot;mm&quot;)
    )
  ) +
  geom_node_point(
    fill = &quot;orange&quot;,
    shape = 21,
    size = 6,
    color = &quot;#555555&quot;
  ) +
  geom_node_text(aes(label = media))</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-19-2.png" width="672" /></p>
<p>The second way to set attributes is to <strong>add them</strong> to the igraph object.</p>
<ul>
<li>Generate colors based on media type:</li>
</ul>
<pre class="r"><code>colrs &lt;- c(&quot;gray50&quot;, &quot;tomato&quot;, &quot;gold&quot;)
V(net)$color &lt;- colrs[V(net)$media.type]
plot(net)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<ul>
<li>Compute node degrees (#links) and use that to set node size:</li>
</ul>
<pre class="r"><code>deg &lt;- igraph::degree(net, mode = &quot;all&quot;)
V(net)$size &lt;- deg*3
# Alternatively, we can set node size based on audience size:
V(net)$size &lt;- V(net)$audience.size*0.7
V(net)$size</code></pre>
<pre><code>##  [1] 14.0 17.5 21.0 22.4 14.0 35.0 39.2 23.8 42.0 16.1 23.8 23.1 16.1  8.4 16.8
## [16] 19.6 23.1</code></pre>
<pre class="r"><code># The labels are currently node IDs.
# Setting them to NA will render no labels:
V(net)$label.color &lt;- &quot;black&quot;
V(net)$label &lt;- NA

# Set edge width based on weight:
E(net)$width &lt;- E(net)$weight/6

#change arrow size and edge color:
E(net)$arrow.size &lt;- .2
E(net)$edge.color &lt;- &quot;gray80&quot;

# We can even set the network layout:
graph_attr(net, &quot;layout&quot;) &lt;- layout_with_lgl
plot(net)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<pre class="r"><code># Using tidygraph
# graph &lt;- tbl_graph(nodes, links, directed = TRUE)
# graph
graph %&gt;%
  activate(nodes) %&gt;%
  mutate(size = centrality_degree()) %&gt;%
  ggraph(., layout = &quot;lgl&quot;) +
  geom_edge_link(
    aes(width = weight),
    color = &quot;grey80&quot;,
    end_cap = circle(.2, &quot;cm&quot;),
    arrow = arrow(
      type = &quot;closed&quot;,
      ends = &quot;last&quot;,
      length = unit(1, &quot;mm&quot;)
    )
  ) +
  geom_node_point(aes(fill = type.label, size = size),
                  shape = 21,
                  color = &quot;black&quot;) +
  scale_fill_manual(name = &quot;Media Type&quot;,
                    values = c(&quot;grey50&quot;, &quot;gold&quot;, &quot;tomato&quot;)) +
  scale_edge_width(range = c(0.2, 1.5), guide = &quot;none&quot;) +
  scale_size_continuous(&quot;Degree&quot;, range =  c(2, 16)) +
  
  guides(fill = guide_legend(title = &quot;Media Type&quot;,
                             override.aes = list(pch = 21, size = 4)))</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>We can also override the attributes explicitly in the plot:</p>
<pre class="r"><code>plot(net, edge.color = &quot;orange&quot;, vertex.color = &quot;gray50&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>We can also add a legend explaining the meaning of the colors we used:</p>
<pre class="r"><code>plot(net)
legend(x = -2.1, y = -1.1, 
       c(&quot;Newspaper&quot;,&quot;Television&quot;, &quot;Online News&quot;), 
       pch = 21,col = &quot;#777777&quot;, 
       pt.bg = colrs, pt.cex = 2.5, bty = &quot;n&quot;, ncol = 1)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<pre class="r"><code># legends are automatic with the tidygraph + ggraph flow</code></pre>
<p>Sometimes, especially with semantic networks, we may be interested in plotting only the labels of the nodes:</p>
<pre class="r"><code>plot(net, vertex.shape = &quot;none&quot;, vertex.label = V(net)$media,
     vertex.label.font = 2, vertex.label.color = &quot;gray40&quot;,
     vertex.label.cex = .7, edge.color = &quot;gray85&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<pre class="r"><code>#using tidygraph

ggraph(net, layout = &quot;gem&quot;) +
  geom_edge_link(color = &quot;grey80&quot;, width = 2,
                 end_cap = circle(0.5,&quot;cm&quot;), 
                 start_cap = circle(0.5, &quot;cm&quot;)) +
    geom_node_text(aes(label = media))</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-25-2.png" width="672" /></p>
<p>Let’s color the edges of the graph based on their source node color. We’ll get the starting node for each edge with <code>ends()</code>.</p>
<p>Note: Edge attribute is being set by start node.</p>
<pre class="r"><code>edge.start &lt;- ends(net, es = E(net), names = F)[,1]
edge.col &lt;- V(net)$color[edge.start] # How simple this is !!!
# The three colors are recycled 
# 
plot(net, edge.color = edge.col, edge.curved = .4)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>NOTE: The source node colour has been set using the <code>media.type</code>, which is a node attribute. Node attributes are not typically accessible to edges. So we need to build a combo data frame using <code>dplyr</code>, so that edges can use this node attribute. ( There may be other ways…)</p>
<pre class="r"><code># Using tidygraph
# Make a &quot;combo&quot; data frame of nodes *and* edges with left_join()
# Join by `from` so that type.label is based on from = edge.start

links %&gt;%
  left_join(., nodes, by = c(&quot;from&quot; = &quot;id&quot;)) %&gt;%
  tbl_graph(edges = ., nodes = nodes) %&gt;%
  
  mutate(size = centrality_degree()) %&gt;%
  
  ggraph(., layout = &quot;lgl&quot;) +
  geom_edge_arc(aes(color = type.label,
                    width = weight),
                strength = 0.3)  +
  geom_node_point(aes(fill = type.label,
                      # type.label is now available as edge attribute
                      size = size),
                  shape = 21,
                  color = &quot;black&quot;) +
  scale_fill_manual(
    name = &quot;Media Type&quot;,
    values = c(&quot;grey50&quot;, &quot;gold&quot;, &quot;tomato&quot;),
    guide = &quot;legend&quot;
  ) +
  scale_edge_color_manual(name = &quot;Source Type&quot;,
                          values = c(&quot;grey80&quot;, &quot;gold&quot;, &quot;tomato&quot;)) +
  scale_edge_width(range = c(0.2, 1.5), guide = &quot;none&quot;) +
  scale_size_continuous(&quot;Degree&quot;, range =  c(2, 16)) +
  # not &quot;limits&quot;!
  guides(fill = guide_legend(override.aes = list(pch = 21,
                                                 size = 4)))</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
<div id="network-layouts-in-igraph" class="section level2">
<h2>——-~~ Network Layouts in ‘igraph’ ——–</h2>
<p>Network layouts are algorithms that return <strong>coordinates</strong> for each node in a network.</p>
<p>Let’s generate a slightly larger 100-node graph using a <code>preferential attachment</code> model (Barabasi-Albert).</p>
<pre class="r"><code>net.bg &lt;- sample_pa(n =  100, power =  1.2)
V(net.bg)$size &lt;- 8
V(net.bg)$frame.color &lt;- &quot;white&quot;
V(net.bg)$color &lt;- &quot;orange&quot;
V(net.bg)$label &lt;- &quot;&quot;
E(net.bg)$arrow.mode &lt;- 0
plot(net.bg)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<pre class="r"><code># Using tidygraph
graph &lt;- play_barabasi_albert(n = 100, power = 1.2)
graph %&gt;%
  ggraph(., layout = &quot;graphopt&quot;) +
  geom_edge_link(color = &quot;grey&quot;) +
  geom_node_point(color = &quot;orange&quot;, size = 4) +
  theme_graph()</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-28-2.png" width="672" /></p>
<p>Now let’s plot this network using the layouts available in igraph. You can set the layout in the plot function:</p>
<pre class="r"><code>plot(net.bg, layout = layout_randomly)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>Or calculate the vertex coordinates in advance:</p>
<pre class="r"><code>l &lt;- layout_in_circle(net.bg)
plot(net.bg, layout = l)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<pre class="r"><code># Using tidygraph
# graph &lt;- play_barabasi_albert(n = 100, power = 1.2)
graph %&gt;% ggraph(., layout = &quot;circle&quot;) +
  geom_edge_link(color = &quot;grey&quot;) +
  geom_node_point(color = &quot;orange&quot;, size = 2) +
  theme_graph() +
  theme(aspect.ratio = 1)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-30-2.png" width="672" /></p>
<p><code>l</code> is simply a matrix of x,y coordinates (N x 2) for the N nodes in the graph. You can generate your own:</p>
<pre class="r"><code>l</code></pre>
<pre><code>##                 [,1]          [,2]
##   [1,]  1.000000e+00  0.000000e+00
##   [2,]  9.980267e-01  6.279052e-02
##   [3,]  9.921147e-01  1.253332e-01
##   [4,]  9.822873e-01  1.873813e-01
##   [5,]  9.685832e-01  2.486899e-01
##   [6,]  9.510565e-01  3.090170e-01
##   [7,]  9.297765e-01  3.681246e-01
##   [8,]  9.048271e-01  4.257793e-01
##   [9,]  8.763067e-01  4.817537e-01
##  [10,]  8.443279e-01  5.358268e-01
##  [11,]  8.090170e-01  5.877853e-01
##  [12,]  7.705132e-01  6.374240e-01
##  [13,]  7.289686e-01  6.845471e-01
##  [14,]  6.845471e-01  7.289686e-01
##  [15,]  6.374240e-01  7.705132e-01
##  [16,]  5.877853e-01  8.090170e-01
##  [17,]  5.358268e-01  8.443279e-01
##  [18,]  4.817537e-01  8.763067e-01
##  [19,]  4.257793e-01  9.048271e-01
##  [20,]  3.681246e-01  9.297765e-01
##  [21,]  3.090170e-01  9.510565e-01
##  [22,]  2.486899e-01  9.685832e-01
##  [23,]  1.873813e-01  9.822873e-01
##  [24,]  1.253332e-01  9.921147e-01
##  [25,]  6.279052e-02  9.980267e-01
##  [26,] -1.608143e-16  1.000000e+00
##  [27,] -6.279052e-02  9.980267e-01
##  [28,] -1.253332e-01  9.921147e-01
##  [29,] -1.873813e-01  9.822873e-01
##  [30,] -2.486899e-01  9.685832e-01
##  [31,] -3.090170e-01  9.510565e-01
##  [32,] -3.681246e-01  9.297765e-01
##  [33,] -4.257793e-01  9.048271e-01
##  [34,] -4.817537e-01  8.763067e-01
##  [35,] -5.358268e-01  8.443279e-01
##  [36,] -5.877853e-01  8.090170e-01
##  [37,] -6.374240e-01  7.705132e-01
##  [38,] -6.845471e-01  7.289686e-01
##  [39,] -7.289686e-01  6.845471e-01
##  [40,] -7.705132e-01  6.374240e-01
##  [41,] -8.090170e-01  5.877853e-01
##  [42,] -8.443279e-01  5.358268e-01
##  [43,] -8.763067e-01  4.817537e-01
##  [44,] -9.048271e-01  4.257793e-01
##  [45,] -9.297765e-01  3.681246e-01
##  [46,] -9.510565e-01  3.090170e-01
##  [47,] -9.685832e-01  2.486899e-01
##  [48,] -9.822873e-01  1.873813e-01
##  [49,] -9.921147e-01  1.253332e-01
##  [50,] -9.980267e-01  6.279052e-02
##  [51,] -1.000000e+00 -3.216286e-16
##  [52,] -9.980267e-01 -6.279052e-02
##  [53,] -9.921147e-01 -1.253332e-01
##  [54,] -9.822873e-01 -1.873813e-01
##  [55,] -9.685832e-01 -2.486899e-01
##  [56,] -9.510565e-01 -3.090170e-01
##  [57,] -9.297765e-01 -3.681246e-01
##  [58,] -9.048271e-01 -4.257793e-01
##  [59,] -8.763067e-01 -4.817537e-01
##  [60,] -8.443279e-01 -5.358268e-01
##  [61,] -8.090170e-01 -5.877853e-01
##  [62,] -7.705132e-01 -6.374240e-01
##  [63,] -7.289686e-01 -6.845471e-01
##  [64,] -6.845471e-01 -7.289686e-01
##  [65,] -6.374240e-01 -7.705132e-01
##  [66,] -5.877853e-01 -8.090170e-01
##  [67,] -5.358268e-01 -8.443279e-01
##  [68,] -4.817537e-01 -8.763067e-01
##  [69,] -4.257793e-01 -9.048271e-01
##  [70,] -3.681246e-01 -9.297765e-01
##  [71,] -3.090170e-01 -9.510565e-01
##  [72,] -2.486899e-01 -9.685832e-01
##  [73,] -1.873813e-01 -9.822873e-01
##  [74,] -1.253332e-01 -9.921147e-01
##  [75,] -6.279052e-02 -9.980267e-01
##  [76,] -1.836910e-16 -1.000000e+00
##  [77,]  6.279052e-02 -9.980267e-01
##  [78,]  1.253332e-01 -9.921147e-01
##  [79,]  1.873813e-01 -9.822873e-01
##  [80,]  2.486899e-01 -9.685832e-01
##  [81,]  3.090170e-01 -9.510565e-01
##  [82,]  3.681246e-01 -9.297765e-01
##  [83,]  4.257793e-01 -9.048271e-01
##  [84,]  4.817537e-01 -8.763067e-01
##  [85,]  5.358268e-01 -8.443279e-01
##  [86,]  5.877853e-01 -8.090170e-01
##  [87,]  6.374240e-01 -7.705132e-01
##  [88,]  6.845471e-01 -7.289686e-01
##  [89,]  7.289686e-01 -6.845471e-01
##  [90,]  7.705132e-01 -6.374240e-01
##  [91,]  8.090170e-01 -5.877853e-01
##  [92,]  8.443279e-01 -5.358268e-01
##  [93,]  8.763067e-01 -4.817537e-01
##  [94,]  9.048271e-01 -4.257793e-01
##  [95,]  9.297765e-01 -3.681246e-01
##  [96,]  9.510565e-01 -3.090170e-01
##  [97,]  9.685832e-01 -2.486899e-01
##  [98,]  9.822873e-01 -1.873813e-01
##  [99,]  9.921147e-01 -1.253332e-01
## [100,]  9.980267e-01 -6.279052e-02</code></pre>
<pre class="r"><code>l &lt;- cbind(1:vcount(net.bg), c(1, vcount(net.bg):2))
plot(net.bg, layout = l)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<pre class="r"><code># Using tidygraph
# graph &lt;- play_barabasi_albert(n = 100, power = 1.2)
graph %&gt;% ggraph(., layout = l) +
  geom_edge_link(color = &quot;grey&quot;) +
  geom_node_point(color = &quot;orange&quot;, size = 2)+
  theme_graph()</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-31-2.png" width="672" /></p>
<p>This layout is just an example and not very helpful - thankfully <code>igraph</code> has a number of built-in layouts, including:</p>
<ul>
<li>Randomly placed vertices</li>
</ul>
<pre class="r"><code>l &lt;- layout_randomly(net.bg)
plot(net.bg, layout = l)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<pre class="r"><code># Using tidygraph
# graph &lt;- play_barabasi_albert(n = 100, power = 1.2)
graph %&gt;% ggraph(., layout = layout_randomly(.)) + 
  geom_edge_link0(colour = &quot;grey&quot;) + 
  geom_node_point(colour = &quot;orange&quot;, size = 4)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-32-2.png" width="672" /></p>
<ul>
<li>Circle layout</li>
</ul>
<pre class="r"><code>l &lt;- layout_in_circle(net.bg)
plot(net.bg, layout = l)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<pre class="r"><code># Using tidygraph
# graph &lt;- play_barabasi_albert(n = 100, power = 1.2)
graph %&gt;% ggraph(., layout = layout_in_circle(.)) + 
  geom_edge_link0(colour = &quot;grey&quot;) + 
  geom_node_point(colour = &quot;orange&quot;) +
  theme(aspect.ratio = 1)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-33-2.png" width="672" /></p>
<ul>
<li>3D sphere layout</li>
</ul>
<pre class="r"><code>l &lt;- layout_on_sphere(net.bg)
plot(net.bg, layout = l)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<pre class="r"><code># Using tidygraph
# graph &lt;- play_barabasi_albert(n = 100, power = 1.2)
graph %&gt;% ggraph(., layout = layout_on_sphere(.)) + 
  geom_edge_link0(colour = &quot;grey&quot;) + 
  geom_node_point(colour = &quot;orange&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-34-2.png" width="672" />
- The Fruchterman-Reingold force-directed algorithm:
Nice but slow, most often used in graphs smaller than ~1000 vertices.</p>
<pre class="r"><code>l &lt;- layout_with_fr(net.bg)
plot(net.bg, layout = l)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<pre class="r"><code># Using tidygraph
# graph &lt;- play_barabasi_albert(n = 100, power = 1.2)
graph %&gt;% ggraph(., layout = layout_with_fr(.)) + 
  geom_edge_link0(colour = &quot;grey&quot;) + 
  geom_node_point(colour = &quot;orange&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-35-2.png" width="672" /></p>
<p>You will also notice that the F-R layout is not deterministic - different runs will result in slightly different configurations. Saving the layout in l allows us to get the exact same result multiple times.</p>
<pre class="r"><code>par(mfrow = c(2,2), mar = c(1,1,1,1))
plot(net.bg, layout = layout_with_fr)
plot(net.bg, layout = layout_with_fr)
plot(net.bg, layout = l)
plot(net.bg, layout = l)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<p>By default, the coordinates of the plots are rescaled to the [-1,1] interval for both x and y. You can change that with the parameter <code>rescale = FALSE</code> and rescale your plot manually by multiplying the coordinates by a scalar. You can use <code>norm_coords</code> to normalize the plot with the boundaries you want. This way you can create more compact or spread out layout versions.</p>
<pre class="r"><code>#Get the layout coordinates:
l &lt;- layout_with_fr(net.bg)
# Normalize them so that they are in the -1, 1 interval:
l &lt;- norm_coords(l, ymin = -1, ymax = 1, xmin = -1, xmax = 1)

par(mfrow = c(2,2), mar = c(0,0,0,0))
plot(net.bg, rescale = F, layout = l*0.4)
plot(net.bg, rescale = F, layout = l*0.8)
plot(net.bg, rescale = F, layout = l*1.2)
plot(net.bg, rescale = F, layout = l*1.6)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<pre class="r"><code># Using tidygraph
# Can&#39;t do this with tidygraph ( multiplying layout * scalar ), it seems</code></pre>
<p>Another popular force-directed algorithm that produces nice results for connected graphs is <strong>Kamada Kawai</strong>. Like Fruchterman Reingold, it attempts to minimize the energy in a spring system.</p>
<pre class="r"><code>l &lt;- layout_with_kk(net.bg)
plot(net.bg, layout = l)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<pre class="r"><code># Using tidygraph
# graph &lt;- play_barabasi_albert(n = 100, power = 1.2)
graph %&gt;% ggraph(., layout = layout_with_kk(.)) + 
  geom_edge_link0(colour = &quot;grey&quot;) + 
  geom_node_point(colour = &quot;orange&quot;, size = 4)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-38-2.png" width="672" /></p>
<p>The <strong>MDS (multidimensional scaling)</strong> algorithm tries to place nodes based on some measure of similarity or distance between them. More similar/less distant nodes are placed closer to each other. By default, the measure used is based on the shortest paths between nodes in the network. That can be changed with the <code>dist</code> parameter.</p>
<pre class="r"><code>plot(net.bg, layout = layout_with_mds)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<pre class="r"><code># Using tidygraph
# graph &lt;- play_barabasi_albert(n = 100, power = 1.2)
graph %&gt;% ggraph(., layout = layout_with_mds(.)) + 
  geom_edge_link0(colour = &quot;grey&quot;) + 
  geom_node_point(colour = &quot;orange&quot;, size = 4)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-39-2.png" width="672" /></p>
<p>The LGL algorithm is for large connected graphs. Here you can specify a <code>root</code>- the node that will be placed in the middle of the layout.</p>
<pre class="r"><code>plot(net.bg, layout = layout_with_lgl)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<pre class="r"><code># Using tidygraph
# graph &lt;- play_barabasi_albert(n = 100, power = 1.2)
graph %&gt;% ggraph(., layout = layout_with_lgl(.)) + 
  geom_edge_link0(colour = &quot;grey&quot;) + 
  geom_node_point(colour = &quot;orange&quot;, size = 4)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-40-2.png" width="672" /></p>
<p>By default, igraph uses a layout called <code>layout_nicely</code> which selects an appropriate layout algorithm based on the properties of the graph. Check out all available layouts in igraph:</p>
<pre class="r"><code>?igraph::layout_</code></pre>
<pre class="r"><code>layouts &lt;- grep(&quot;^layout_&quot;, ls(&quot;package:igraph&quot;), value = TRUE)[-1]

# Remove layouts that do not apply to our graph.
layouts &lt;- layouts[!grepl(&quot;bipartite|merge|norm|sugiyama|tree&quot;, layouts)]

par(mfrow = c(3,3), mar = c(1,1,1,1))

for (layout in layouts) {
  print(layout)
  l &lt;- do.call(layout, list(net))
  plot(net, edge.arrow.mode = 0, layout = l, main = layout) }</code></pre>
<pre><code>## [1] &quot;layout_as_star&quot;</code></pre>
<pre><code>## [1] &quot;layout_components&quot;</code></pre>
<pre><code>## [1] &quot;layout_in_circle&quot;</code></pre>
<pre><code>## [1] &quot;layout_nicely&quot;</code></pre>
<pre><code>## [1] &quot;layout_on_grid&quot;</code></pre>
<pre><code>## [1] &quot;layout_on_sphere&quot;</code></pre>
<pre><code>## [1] &quot;layout_randomly&quot;</code></pre>
<pre><code>## [1] &quot;layout_with_dh&quot;</code></pre>
<pre><code>## [1] &quot;layout_with_drl&quot;</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<pre><code>## [1] &quot;layout_with_fr&quot;</code></pre>
<pre><code>## [1] &quot;layout_with_gem&quot;</code></pre>
<pre><code>## [1] &quot;layout_with_graphopt&quot;</code></pre>
<pre><code>## [1] &quot;layout_with_kk&quot;</code></pre>
<pre><code>## [1] &quot;layout_with_lgl&quot;</code></pre>
<pre><code>## [1] &quot;layout_with_mds&quot;</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-42-2.png" width="672" /></p>
</div>
</div>
<div id="highlighting-aspects-of-the-network" class="section level1">
<h1>——-~~ Highlighting aspects of the network ——–</h1>
<pre class="r"><code>plot(net)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>Notice that our network plot is still not too helpful. We can identify the type and size of nodes, but cannot see much about the structure since the links we’re examining are so dense. One way to approach this is to see if we can sparsify the network.</p>
<pre class="r"><code>hist(links$weight)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<pre class="r"><code>mean(links$weight)</code></pre>
<pre><code>## [1] 12.40816</code></pre>
<pre class="r"><code>sd(links$weight)</code></pre>
<pre><code>## [1] 9.905635</code></pre>
<p>There are more sophisticated ways to extract the key edges, but for the purposes of this exercise we’ll only keep ones that have weight higher than the mean for the network. We can delete edges using <code>delete_edges(net, edges)</code> (or, by the way, add edges with <code>add_edges(net, edges)</code> )</p>
<pre class="r"><code>cut.off &lt;- mean(links$weight)
net.sp &lt;- delete_edges(net, E(net)[weight&lt;cut.off])
plot(net.sp, layout = layout_with_kk)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<pre class="r"><code># Using tidygraph
graph &lt;- tbl_graph(nodes, links, directed = TRUE) 
graph</code></pre>
<pre><code>## # A tbl_graph: 17 nodes and 49 edges
## #
## # A directed multigraph with 1 component
## #
## # Node Data: 17 x 5 (active)
##   id    media               media.type type.label audience.size
##   &lt;chr&gt; &lt;chr&gt;                    &lt;int&gt; &lt;chr&gt;              &lt;int&gt;
## 1 s01   NY Times                     1 Newspaper             20
## 2 s02   Washington Post              1 Newspaper             25
## 3 s03   Wall Street Journal          1 Newspaper             30
## 4 s04   USA Today                    1 Newspaper             32
## 5 s05   LA Times                     1 Newspaper             20
## 6 s06   New York Post                1 Newspaper             50
## # ... with 11 more rows
## #
## # Edge Data: 49 x 4
##    from    to type      weight
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;int&gt;
## 1     1     2 hyperlink     22
## 2     1     3 hyperlink     22
## 3     1     4 hyperlink     21
## # ... with 46 more rows</code></pre>
<pre class="r"><code>graph %&gt;%
  activate(nodes) %&gt;%
  mutate(size = centrality_degree()) %&gt;%
  
  # New stuff here
  activate(edges) %&gt;% 
  filter(weight &gt;= mean(weight)) %&gt;% 
  
  ggraph(., layout = &quot;kk&quot;) +
  geom_edge_link(
    aes(width = weight),
    color = &quot;grey80&quot;,
    end_cap = circle(.2, &quot;cm&quot;),
    
    arrow = arrow(
      type = &quot;closed&quot;,
      ends = &quot;last&quot;,
      length = unit(1, &quot;mm&quot;)
    )) +
  geom_node_point(aes(fill = type.label,
                      size = size),
                  shape = 21,
                  color = &quot;black&quot;) +
  scale_fill_manual(
    name = &quot;Media Type&quot;,
    values = c(&quot;grey50&quot;, &quot;gold&quot;, &quot;tomato&quot;),
    guide = &quot;legend&quot;) +
  
  scale_edge_width(range = c(0.2, 1.5), guide = &quot;none&quot;) +
  scale_size_continuous(&quot;Degree&quot;, range =  c(2, 16)) +
  # not &quot;limits&quot;!
  guides(fill = guide_legend(override.aes = list(pch = 21,
                                                 size = 4)))</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-45-2.png" width="672" /></p>
<p>Another way to think about this is to plot the two tie types (hyperlinks and mentions) separately. We will do that in section 5 of this tutorial: Plotting multiplex networks.</p>
<div id="community-detection" class="section level3">
<h3>Community Detection</h3>
<p>We can also try to make the network map more useful by showing the communities within it.</p>
<pre class="r"><code>#Community detection (by optimizing modularity over partitions):
clp &lt;- cluster_optimal(net)
class(clp)</code></pre>
<pre><code>## [1] &quot;communities&quot;</code></pre>
<pre class="r"><code>clp</code></pre>
<pre><code>## IGRAPH clustering optimal, groups: 4, mod: 0.6
## + groups:
##   $`1`
##   [1] &quot;s01&quot; &quot;s02&quot; &quot;s03&quot; &quot;s04&quot; &quot;s05&quot; &quot;s11&quot; &quot;s15&quot;
##   
##   $`2`
##   [1] &quot;s06&quot; &quot;s16&quot; &quot;s17&quot;
##   
##   $`3`
##   [1] &quot;s07&quot; &quot;s08&quot; &quot;s09&quot; &quot;s10&quot;
##   
##   $`4`
##   + ... omitted several groups/vertices</code></pre>
<pre class="r"><code>clp$membership</code></pre>
<pre><code>##  [1] 1 1 1 1 1 2 3 3 3 3 1 4 4 4 1 2 2</code></pre>
<p>Community detection returns an object of class “communities” which igraph knows how to plot:</p>
<pre class="r"><code>plot(clp, net)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<p>To plot communities using the <code>tidygraph</code> approach, I have taken help from the <code>ggforce</code> package. This package allows drawing of hull shapes around specific sets of points. Here goes:</p>
<pre class="r"><code># Using tidygraph
# And ggforce
library(ggforce)
graph &lt;- tbl_graph(nodes, links, directed = TRUE) 
graph &lt;- graph %&gt;%
  activate(nodes) %&gt;%
  mutate(size = centrality_degree()) %&gt;%
  # new stuff
  mutate(community = as.factor(tidygraph::group_optimal()))

# Need to pre-compute layout coordinates to pass to ggforce
# To create a hull around each community
layout_go &lt;- layout_with_graphopt(graph)
  
ggraph(graph, layout = layout_go) +
  
 # new stuff
 # need to pass x and y coordinates of nodes to `geom_mark_hull`
 # Hull colour is `community`
 #
  ggforce::geom_mark_hull(aes(x = layout_go[, 1],
                     y = layout_go[, 2],
                     color = community)) +
  
  geom_edge_link(
    aes(width = weight),
    color = &quot;grey80&quot;,
    end_cap = circle(.2, &quot;cm&quot;),
    
    arrow = arrow(
      type = &quot;closed&quot;,
      ends = &quot;last&quot;,
      length = unit(1, &quot;mm&quot;)
    )
  ) +
  geom_node_point(aes(fill = type.label,
                      size = size),
                  shape = 21,
                  color = &quot;black&quot;) +
  scale_edge_width(range = c(0.2, 1.5), guide = &quot;none&quot;) +
  scale_size_continuous(&quot;Degree&quot;, range =  c(2, 10)) +
  scale_fill_discrete(&quot;Media Type&quot;) +
  scale_colour_discrete(&quot;Community&quot;) +
  guides(fill = guide_legend(override.aes = list(pch = 21,
                                                 size = 4)))</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<p>We can also plot the communities without relying on their built-in plot:</p>
<pre class="r"><code>V(net)$community &lt;- clp$membership
colrs &lt;-
  adjustcolor(c(&quot;gray50&quot;, &quot;tomato&quot;, &quot;gold&quot;, &quot;yellowgreen&quot;), alpha = .6)
plot(net, vertex.color = colrs[V(net)$community])</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<pre class="r"><code># using tidygraph
# All clustering algorithms from igraph is available in tidygraph using the group_* prefix. All of these functions return an integer vector with nodes (or edges) sharing the same integer being grouped together.
graph &lt;- tbl_graph(nodes, links, directed = TRUE) 
graph</code></pre>
<pre><code>## # A tbl_graph: 17 nodes and 49 edges
## #
## # A directed multigraph with 1 component
## #
## # Node Data: 17 x 5 (active)
##   id    media               media.type type.label audience.size
##   &lt;chr&gt; &lt;chr&gt;                    &lt;int&gt; &lt;chr&gt;              &lt;int&gt;
## 1 s01   NY Times                     1 Newspaper             20
## 2 s02   Washington Post              1 Newspaper             25
## 3 s03   Wall Street Journal          1 Newspaper             30
## 4 s04   USA Today                    1 Newspaper             32
## 5 s05   LA Times                     1 Newspaper             20
## 6 s06   New York Post                1 Newspaper             50
## # ... with 11 more rows
## #
## # Edge Data: 49 x 4
##    from    to type      weight
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;int&gt;
## 1     1     2 hyperlink     22
## 2     1     3 hyperlink     22
## 3     1     4 hyperlink     21
## # ... with 46 more rows</code></pre>
<pre class="r"><code>graph %&gt;%
  activate(nodes) %&gt;%
  mutate(size = centrality_degree()) %&gt;%
  
  # new stuff
  mutate(community = as.factor(tidygraph::group_optimal())) %&gt;% 
  
  ggraph(., layout = &quot;graphopt&quot;) +
  geom_edge_link(
    aes(width = weight),
    color = &quot;grey80&quot;,
    end_cap = circle(.2, &quot;cm&quot;),
    # clears an area near the node
    
    arrow = arrow(
      type = &quot;closed&quot;,
      ends = &quot;last&quot;,
      length = unit(1, &quot;mm&quot;)
    )) +
  geom_node_point(aes(fill = community,
                      size = size),
                  shape = 21,
                  color = &quot;black&quot;) +
  scale_fill_manual(
    name = &quot;Community&quot;,
    values = c(&quot;grey50&quot;, &quot;gold&quot;, &quot;tomato&quot;, &quot;yellowgreen&quot;),
    guide = &quot;legend&quot;) +

  scale_edge_width(range = c(0.2, 1.5), guide = &quot;none&quot;) +
  scale_size_continuous(&quot;Degree&quot;, range =  c(2, 10)) +
  guides(fill = guide_legend(override.aes = list(pch = 21,
                                                 size = 4)))</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-49-2.png" width="672" /></p>
</div>
<div id="highlighting-specific-nodes-or-links" class="section level2">
<h2>——-~~ Highlighting specific nodes or links ——–</h2>
<p>Sometimes we want to focus the visualization on a particular node or a group of nodes. Let’s represent distance from the NYT:</p>
<ul>
<li><code>distances()</code> calculates shortest path from vertices in ‘v’ to ones in ‘to’.</li>
</ul>
<pre class="r"><code>dist.from.NYT &lt;- distances(net, 
                           v = V(net)[media == &quot;NY Times&quot;], 
                           to = V(net), 
                           weights = NA)

#Set colors to plot the distances:
oranges &lt;- colorRampPalette(c(&quot;dark red&quot;, &quot;gold&quot;))
col &lt;- oranges(max(dist.from.NYT)+1)
col &lt;- col[dist.from.NYT+1]

# Let&#39;s have same coordinates for Nodes in both graph renderings
# Then we can verify that the distance calculations are the same for both renderings
coords &lt;- igraph::layout_nicely(net)
plot(net, vertex.label = dist.from.NYT,
     vertex.color = col, vertex.label.color = &quot;black&quot;,
     layout = coords)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<pre class="r"><code># Using tidygraph
graph &lt;- tbl_graph(nodes, links, directed = TRUE)
graph</code></pre>
<pre><code>## # A tbl_graph: 17 nodes and 49 edges
## #
## # A directed multigraph with 1 component
## #
## # Node Data: 17 x 5 (active)
##   id    media               media.type type.label audience.size
##   &lt;chr&gt; &lt;chr&gt;                    &lt;int&gt; &lt;chr&gt;              &lt;int&gt;
## 1 s01   NY Times                     1 Newspaper             20
## 2 s02   Washington Post              1 Newspaper             25
## 3 s03   Wall Street Journal          1 Newspaper             30
## 4 s04   USA Today                    1 Newspaper             32
## 5 s05   LA Times                     1 Newspaper             20
## 6 s06   New York Post                1 Newspaper             50
## # ... with 11 more rows
## #
## # Edge Data: 49 x 4
##    from    to type      weight
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;int&gt;
## 1     1     2 hyperlink     22
## 2     1     3 hyperlink     22
## 3     1     4 hyperlink     21
## # ... with 46 more rows</code></pre>
<pre class="r"><code># Set up NY Times as root node first
# V(net)[media == &quot;NY Times&quot;] cannot be used since it returns an `igraph.vs` ( i.e. a list ) object. 
# We need an integer node id.
root_nyt &lt;- graph %&gt;%
  activate(nodes) %&gt;%
  as_tibble() %&gt;%
  rowid_to_column(var = &quot;node_id&quot;) %&gt;%
  filter(media == &quot;NY Times&quot;) %&gt;%
  select(node_id) %&gt;% as_vector()
root_nyt</code></pre>
<pre><code>## node_id 
##       1</code></pre>
<pre class="r"><code>graph %&gt;%
  activate(nodes) %&gt;%
  mutate(size = centrality_degree()) %&gt;%
  
  # new stuff:
  # breadth first search for all distances from the root node
  mutate(order = bfs_dist(root = root_nyt)) %&gt;%
  
  ggraph(., layout = coords) + # same layout
  geom_edge_link(
    aes(width = weight),
    color = &quot;grey80&quot;,
    end_cap = circle(.2, &quot;cm&quot;),
    arrow = arrow(
      type = &quot;closed&quot;,
      ends = &quot;last&quot;,
      length = unit(1, &quot;mm&quot;)
    )
  ) +
  geom_node_point(aes(fill = order,
                      size = size),
                  shape = 21,
                  color = &quot;black&quot;) +
  
  geom_node_text(aes(label = order)) +
  
  scale_fill_gradient(
    name = &quot;Distance from NY Times&quot;,
    low = &quot;dark red&quot;,
    high = &quot;gold&quot;,
    guide = &quot;legend&quot;
  ) +
  scale_edge_width(range = c(0.2, 1.5), guide = &quot;none&quot;) +
  scale_size_continuous(&quot;Degree&quot;, range =  c(2, 16)) +
  guides(fill = guide_legend(override.aes = list(pch = 21,
                                                 size = 4)))</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<p>Or, a bit more readable:</p>
<pre class="r"><code>plot(net, vertex.color = col, 
     vertex.label = dist.from.NYT, edge.arrow.size = .6,
     vertex.label.color = &quot;white&quot;, 
     vertex.size = V(net)$size*1.6, 
     edge.width = 2,
     layout = norm_coords(layout_with_lgl(net))*1.4, rescale = F)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
</div>
<div id="path-highlighting" class="section level2">
<h2>Path Highlighting</h2>
<p>We can also highlight paths between the nodes in the network.</p>
<ul>
<li>Say here between MSNBC and the New York Post</li>
</ul>
<pre class="r"><code>news.path &lt;- shortest_paths(net,
                            from  =  V(net)[media == &quot;MSNBC&quot;],
                            to   =  V(net)[media == &quot;New York Post&quot;],
                            output  =  &quot;both&quot;)  #both path nodes and edges
news.path.distance &lt;- distances(net,
                                V(net)[media == &quot;MSNBC&quot;],
                                V(net)[media == &quot;New York Post&quot;] )
news.path</code></pre>
<pre><code>## $vpath
## $vpath[[1]]
## + 4/17 vertices, named, from b7994bb:
## [1] s08 s03 s12 s06
## 
## 
## $epath
## $epath[[1]]
## + 3/48 edges from b7994bb (vertex names):
## [1] s08-&gt;s03 s03-&gt;s12 s12-&gt;s06
## 
## 
## $predecessors
## NULL
## 
## $inbound_edges
## NULL</code></pre>
<pre class="r"><code>news.path.distance</code></pre>
<pre><code>##     s06
## s08   5</code></pre>
<pre class="r"><code>#Generate edge color variable to plot the path:
ecol &lt;- rep(&quot;gray80&quot;, ecount(net))
ecol[unlist(news.path$epath)] &lt;- &quot;orange&quot;

#Generate edge width variable to plot the path:
ew &lt;- rep(2, ecount(net))
ew[unlist(news.path$epath)] &lt;- 4

#Generate node color variable to plot the path:
vcol &lt;- rep(&quot;gray40&quot;, vcount(net))
vcol[unlist(news.path$vpath)] &lt;- &quot;gold&quot;

plot(net, vertex.color = vcol, 
     edge.color = ecol,
     edge.width = ew, 
     edge.arrow.mode = 0,
     ## added lines
     vertex.label = V(net)$media,
     vertex.label.font = 2, 
     vertex.label.color = &quot;gray40&quot;,
     vertex.label.cex = .7,
     layout = coords * 1.5)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<pre class="r"><code># Using tidygraph
# We need to use:
# to_shortest_path(graph, from, to, mode = &quot;out&quot;, weights = NULL)
# Let&#39;s set up `to` and `from` nodes
#
# V(net)[media == &quot;NY Times&quot;] cannot be used since it returns an `igraph.vs` ( i.e. a list ) object.
# We need integer node ids for `from` and `to` in `to_shortest_path`

msnbc &lt;- graph %&gt;%
  activate(nodes) %&gt;%
  as_tibble() %&gt;%
  rowid_to_column(var = &quot;node_id&quot;) %&gt;%
  filter(media == &quot;MSNBC&quot;) %&gt;%
  select(node_id) %&gt;% as_vector()
msnbc</code></pre>
<pre><code>## node_id 
##       8</code></pre>
<pre class="r"><code>nypost &lt;- graph %&gt;%
  activate(nodes) %&gt;%
  as_tibble() %&gt;%
  rowid_to_column(var = &quot;node_id&quot;) %&gt;%
  filter(media == &quot;New York Post&quot;) %&gt;%
  select(node_id) %&gt;% as_vector()
nypost</code></pre>
<pre><code>## node_id 
##       6</code></pre>
<pre class="r"><code># Let&#39;s create a fresh graph object using morph
# However we want to merge it back with the original `graph`
# to get an overlay plot
#
# # Can do this to obtain a separate graph
# convert(to_shortest_path,from = msnbc,to = nypost)
# However we want to merge it back with the original `graph`
# to get an overlay plot
msnbc_nyp &lt;-
  graph %&gt;%
  # first mark all nodes and edges as *not* on the shortest path
  activate(nodes) %&gt;%
  mutate(shortest_path_node = FALSE) %&gt;%
  activate(edges) %&gt;%
  mutate(shortest_path_edge = FALSE) %&gt;%
  
  # Find shortest path between MSNBC and NY Post
  morph(to_shortest_path, from = msnbc, to = nypost) %&gt;%
  
  # Now to mark the shortest_path nodes as TRUE
  activate(nodes) %&gt;%
  mutate(shortest_path_node = TRUE) %&gt;%
  
  # Now to mark the shortest_path edges as TRUE
  activate(edges) %&gt;%
  mutate(shortest_path_edge = TRUE) %&gt;%
  #
  # Merge back into main graph; Still saving it as a `msnbc_nyp`
  unmorph()
msnbc_nyp</code></pre>
<pre><code>## # A tbl_graph: 17 nodes and 49 edges
## #
## # A directed multigraph with 1 component
## #
## # Edge Data: 49 x 5 (active)
##    from    to type      weight shortest_path_edge
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;int&gt; &lt;lgl&gt;             
## 1     1     2 hyperlink     22 FALSE             
## 2     1     3 hyperlink     22 FALSE             
## 3     1     4 hyperlink     21 FALSE             
## 4     1    15 mention       20 FALSE             
## 5     2     1 hyperlink     23 FALSE             
## 6     2     3 hyperlink     21 FALSE             
## # ... with 43 more rows
## #
## # Node Data: 17 x 6
##   id    media              media.type type.label audience.size shortest_path_no~
##   &lt;chr&gt; &lt;chr&gt;                   &lt;int&gt; &lt;chr&gt;              &lt;int&gt; &lt;lgl&gt;            
## 1 s01   NY Times                    1 Newspaper             20 FALSE            
## 2 s02   Washington Post             1 Newspaper             25 FALSE            
## 3 s03   Wall Street Journ~          1 Newspaper             30 TRUE             
## # ... with 14 more rows</code></pre>
<pre class="r"><code>msnbc_nyp %&gt;%
  activate(nodes) %&gt;%
  mutate(size = centrality_degree()) %&gt;%
  ggraph(layout = coords) +
  #geom_edge_link0(colour = &quot;grey&quot;) +
  geom_edge_link0(aes(colour = shortest_path_edge,
                      width = shortest_path_edge)) +
  
  geom_node_point(aes(size = size,
                      fill = shortest_path_node), shape = 21) +
  geom_node_text(aes(label = media)) +
  
  scale_size_continuous(&quot;Degree&quot;, range =  c(2, 16)) +
  scale_fill_manual(&quot;Shortest Path&quot;,
                    values = c(&quot;grey&quot;, &quot;gold&quot;)) +
  
  scale_edge_width_manual(values = c(1, 4)) +
  
  scale_edge_colour_manual(values = c(&quot;grey&quot;, &quot;orange&quot;)) +
  guides(
    fill = guide_legend(override.aes = list(pch = 21,
                                            size = 6)),
    edge_colour = &quot;none&quot;,
    edge_width = &quot;none&quot;
  )</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<ul>
<li>Highlight the edges going into or out of a vertex, for instance the WSJ. For a single node, use <code>incident()</code>, for multiple nodes use <code>incident_edges()</code></li>
</ul>
<pre class="r"><code>inc.edges &lt;-
  incident(net, V(net)[media == &quot;Wall Street Journal&quot;], mode = &quot;all&quot;)

#Set colors to plot the selected edges.
ecol &lt;- rep(&quot;gray80&quot;, ecount(net))
ecol[inc.edges] &lt;- &quot;orange&quot;
vcol &lt;- rep(&quot;grey40&quot;, vcount(net))
vcol[V(net)$media == &quot;Wall Street Journal&quot;] &lt;- &quot;gold&quot;
plot(
  net,
  vertex.color = vcol,
  edge.color = ecol,
  edge.width = 2,
  layout = coords
)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
<pre class="r"><code># Using tidygraph
wsj &lt;- graph %&gt;% 
  activate(nodes) %&gt;% 
  as_tibble() %&gt;% 
  rowid_to_column(var = &quot;node_id&quot;) %&gt;% 
  filter(media == &quot;Wall Street Journal&quot;) %&gt;% 
  select(node_id) %&gt;% as_vector()

graph %&gt;% 
  activate(nodes) %&gt;% 
  mutate(wsj_adjacent = node_is_adjacent(to = wsj, mode = &quot;all&quot;, 
                                         include_to = TRUE),
         size = centrality_degree()) %&gt;% 
  mutate(WSJ = if_else(media == &quot;Wall Street Journal&quot;, TRUE, FALSE)) %&gt;% 
  activate(edges) %&gt;% 
  mutate(wsj_links = edge_is_incident(wsj)) %&gt;% 
  
  ggraph(., layout = coords) +
  geom_edge_link0(aes(colour = wsj_links), width = 2) + 
  
  geom_node_point(aes(fill = WSJ, 
                      size = size),shape = 21) +
  
  geom_node_text(aes(label = media), repel = TRUE) + 
  
  scale_fill_manual(&quot;WSJ Neighbours&quot;, 
                      values = c(&quot;grey&quot;, &quot;gold&quot;), 
                      guide = guide_legend(override.aes = 
                                             list(pch = 21, 
                                                  size = 5))) + 
  scale_edge_colour_manual(&quot;WSJ Links&quot;, 
                      values = c(&quot;grey&quot;, &quot;orange&quot;)) + 
  scale_size(&quot;Degree&quot;, range = c( 2, 16)) +
  ggtitle(label = &quot;Highlighting WSJ Neighbours and Links&quot;) +
  guides(shape = &quot;none&quot;, fill = &quot;none&quot; #, colour = &quot;none&quot;
  )</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
</div>
<div id="highlight-neighbours" class="section level2">
<h2>Highlight Neighbours</h2>
<p>Or we can highlight the immediate neighbors of a vertex, say WSJ. The <code>neighbors</code> function finds all nodes one step out from the focal actor. To find the neighbors for multiple nodes, use <code>adjacent_vertices()</code>. To find node neighborhoods going more than one step out, use function <code>ego()</code> with parameter <code>order</code> set to the number of steps out to go from the focal node(s).</p>
<pre class="r"><code>neigh.nodes &lt;- neighbors(net, V(net)[media == &quot;Wall Street Journal&quot;], mode = &quot;out&quot;)

# Set colors to plot the neighbors:
vcol[neigh.nodes] &lt;- &quot;#ff9d00&quot;
plot(net, vertex.color = vcol)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<pre class="r"><code># Using tidygraph
wsj &lt;- graph %&gt;% 
  activate(nodes) %&gt;% 
  as_tibble() %&gt;% 
  rowid_to_column(var = &quot;node_id&quot;) %&gt;% 
  filter(media == &quot;Wall Street Journal&quot;) %&gt;% 
  select(node_id) %&gt;% as_vector()

graph %&gt;% 
  activate(nodes) %&gt;% 
  mutate(wsj_adjacent = node_is_adjacent(to = wsj, mode = &quot;all&quot;, 
  # remove WSJ from the list!
  # highlight only the neighbours
  
                                         include_to = FALSE),
         size = centrality_degree()) %&gt;% 
  mutate(WSJ = if_else(media == &quot;Wall Street Journal&quot;, TRUE, FALSE)) %&gt;% 
  activate(edges) %&gt;% 
  mutate(wsj_links = edge_is_incident(wsj)) %&gt;% 
  
  ggraph(., layout = coords) +
  geom_edge_link0(aes(colour = wsj_links), width = 2) + 
  
  geom_node_point(aes(fill = wsj_adjacent, 
                      size = size),shape = 21) +
  
  geom_node_text(aes(label = media), repel = TRUE) + 
  
  scale_fill_manual(&quot;WSJ Neighbours&quot;, 
                      values = c(&quot;grey&quot;, &quot;gold&quot;), 
                      guide = guide_legend(override.aes = 
                                             list(pch = 21, 
                                                  size = 5))) + 
  scale_edge_colour_manual(&quot;WSJ Links&quot;, 
                      values = c(&quot;grey&quot;, &quot;orange&quot;)) + 
  scale_size(&quot;Degree&quot;, range = c( 2, 16)) +
  ggtitle(label = &quot;Highlighting WSJ Neighbours and Links&quot;) +
  guides(shape = &quot;none&quot;, fill = &quot;none&quot; #, colour = &quot;none&quot;
  )</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<p>Another way to draw attention to a group of nodes: (This is generally not recommended since, depending on layout, nodes that are not ‘marked’ can accidentally get placed on top of the mark)</p>
<pre class="r"><code>plot(net, mark.groups = c(1,4,5,8), mark.col = &quot;#C5E5E7&quot;, mark.border = NA)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<pre class="r"><code># Mark multiple groups:
plot(net, mark.groups = list(c(1,4,5,8), c(15:17)),
          mark.col = c(&quot;#C5E5E7&quot;,&quot;#ECD89A&quot;), mark.border = NA)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-59-2.png" width="672" /></p>
</div>
<div id="interactive-plotting-with-tkplot" class="section level2">
<h2>——-~~ Interactive plotting with ‘tkplot’ ——–</h2>
<p>R and igraph offer interactive plotting capabilities (mostly helpful for small networks)</p>
<pre class="r"><code>tkid &lt;- tkplot(net) #tkid is the id of the tkplot

l &lt;- tkplot.getcoords(tkid) # grab the coordinates from tkplot
plot(net, layout = l)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-60-1.png" width="672" /></p>
</div>
<div id="other-ways-to-represent-a-network" class="section level2">
<h2>——-~~ Other ways to represent a network ——–</h2>
<p>One reminder that there are other ways to represent a network:</p>
<ul>
<li>Heatmap of the network matrix:</li>
</ul>
<pre class="r"><code>netm &lt;- as_adjacency_matrix(net, attr = &quot;weight&quot;, sparse = F)
colnames(netm) &lt;- V(net)$media
rownames(netm) &lt;- V(net)$media

palf &lt;- colorRampPalette(c(&quot;gold&quot;, &quot;dark orange&quot;))

# The Rowv &amp; Colv parameters turn dendrograms on and off
heatmap(netm[,17:1], Rowv  =  NA, Colv  =  NA, col  =  palf(20),
        scale = &quot;none&quot;, margins = c(10,10) )</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
<ul>
<li>Degree distribution</li>
</ul>
<pre class="r"><code>deg.dist &lt;- degree_distribution(net, cumulative = T, mode = &quot;all&quot;)
# degree is available in `sna` too
plot(x = 0:max(igraph::degree(net)), y = 1-deg.dist, pch = 19, cex = 1.4, col = &quot;orange&quot;, xlab = &quot;Degree&quot;, ylab = &quot;Cumulative Frequency&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
<pre class="r"><code># Using Tidygraph
# https://stackoverflow.com/questions/18356860/cumulative-histogram-with-ggplot2
graph %&gt;% 
  activate(nodes) %&gt;% 
  mutate(degree = centrality_degree(mode = &quot;all&quot;)) %&gt;% 
  as_tibble() %&gt;% 
  ggplot(aes(x = degree, y = stat(count))) +
  # geom_histogram(aes(y = cumsum(..count..)), binwidth = 1) + 
  stat_bin(aes(y = cumsum(..count..)),
                binwidth = 1,# Ta-Da !!
                geom =&quot;point&quot;,color =&quot;orange&quot;, size = 5)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-62-2.png" width="672" /></p>
</div>
<div id="plotting-two-mode-networks" class="section level2">
<h2>4. Plotting two-mode networks</h2>
<pre class="r"><code>head(nodes2)</code></pre>
<pre><code>##    id   media media.type media.name audience.size
## 1 s01     NYT          1  Newspaper            20
## 2 s02    WaPo          1  Newspaper            25
## 3 s03     WSJ          1  Newspaper            30
## 4 s04    USAT          1  Newspaper            32
## 5 s05 LATimes          1  Newspaper            20
## 6 s06     CNN          2         TV            56</code></pre>
<pre class="r"><code>head(links2)</code></pre>
<pre><code>##     U01 U02 U03 U04 U05 U06 U07 U08 U09 U10 U11 U12 U13 U14 U15 U16 U17 U18 U19
## s01   1   1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
## s02   0   0   0   1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0
## s03   0   0   0   0   0   1   1   1   1   0   0   0   0   0   0   0   0   0   0
## s04   0   0   0   0   0   0   0   0   1   1   1   0   0   0   0   0   0   0   0
## s05   0   0   0   0   0   0   0   0   0   0   1   1   1   0   0   0   0   0   0
## s06   0   0   0   0   0   0   0   0   0   0   0   0   1   1   0   0   1   0   0
##     U20
## s01   0
## s02   1
## s03   0
## s04   0
## s05   0
## s06   0</code></pre>
<pre class="r"><code>net2</code></pre>
<pre><code>## IGRAPH b85369e UN-B 30 31 -- 
## + attr: type (v/l), name (v/c)
## + edges from b85369e (vertex names):
##  [1] s01--U01 s01--U02 s01--U03 s02--U04 s02--U05 s02--U20 s03--U06 s03--U07
##  [9] s03--U08 s03--U09 s04--U09 s04--U10 s04--U11 s05--U11 s05--U12 s05--U13
## [17] s06--U13 s06--U14 s06--U17 s07--U14 s07--U15 s07--U16 s08--U16 s08--U17
## [25] s08--U18 s08--U19 s09--U06 s09--U19 s09--U20 s10--U01 s10--U11</code></pre>
<pre class="r"><code>plot(net2)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
<p>This time we will make nodes look different based on their type. Media outlets are blue squares, audience nodes are orange circles:</p>
<pre class="r"><code>V(net2)$color &lt;- c(&quot;steel blue&quot;, &quot;orange&quot;)[V(net2)$type+1]
V(net2)$shape &lt;- c(&quot;square&quot;, &quot;circle&quot;)[V(net2)$type+1]

# Media outlets will have name labels, audience members will not:
V(net2)$label &lt;- &quot;&quot;
V(net2)$label[V(net2)$type == F] &lt;- nodes2$media[V(net2)$type == F]
V(net2)$label.cex = .6
V(net2)$label.font = 2

plot(net2, vertex.label.color = &quot;white&quot;, vertex.size = (2-V(net2)$type)*8)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<pre class="r"><code># Using tidygraph
as_tbl_graph(x = links2, directed = TRUE) %&gt;%
  activate(nodes) %&gt;%
  left_join(nodes2, by = c(&quot;name&quot; = &quot;id&quot;)) %&gt;%
  ggraph(layout = &quot;nicely&quot;) +
  geom_edge_link0() +
  geom_node_point(aes(shape = type, fill = type, size = type)) +
  geom_node_text(aes(label = if_else(type, &quot;&quot;, media)), colour = &quot;white&quot;, size = 3) +
  
  scale_shape_manual(
    &quot;Type&quot;,
    values = c(22, 21),
    labels = c(&quot;Media&quot;, &quot;Persons&quot;),
    guide = guide_legend(override.aes = list(size = 6))
  ) +
  
  scale_fill_manual(
    &quot;Type&quot;,
    values = c(&quot;dodgerblue&quot;, &quot;orange&quot;),
    labels = c(&quot;Media&quot;, &quot;Persons&quot;)
  ) +
  
  scale_size_manual(values = c(10, 4), guide = &quot;none&quot;) </code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-65-1.png" width="672" /></p>
<p><code>igraph</code> has a built-in bipartite layout, though it’s not the most helpful:</p>
<pre class="r"><code>plot(net2, vertex.label = NA, vertex.size = 7, layout = layout_as_bipartite)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
<pre class="r"><code># using tidygraph
as_tbl_graph(x = links2, directed = TRUE) %&gt;%
  activate(nodes) %&gt;%
  left_join(nodes2, by = c(&quot;name&quot; = &quot;id&quot;)) %&gt;%
  ggraph(., layout = &quot;igraph&quot;, algorithm = &quot;bipartite&quot;) +
  geom_edge_link0() +
  geom_node_point(aes(shape = type, fill = type, size = type)) +
  geom_node_text(aes(label = if_else(type, &quot;&quot;, media)), colour = &quot;white&quot;, size = 3) +
  
  scale_shape_manual(
    &quot;Type&quot;,
    values = c(22, 21),
    labels = c(&quot;Media&quot;, &quot;Persons&quot;),
    guide = guide_legend(override.aes = list(size = 6))
  ) +
  
  scale_fill_manual(
    &quot;Type&quot;,
    values = c(&quot;dodgerblue&quot;, &quot;orange&quot;),
    labels = c(&quot;Media&quot;, &quot;Persons&quot;)
  ) +
  
  scale_size_manual(values = c(10, 4), guide = &quot;none&quot;) </code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-66-2.png" width="672" /></p>
<ul>
<li>Using text as nodes:</li>
</ul>
<pre class="r"><code>par(mar = c(0,0,0,0))
plot(net2, vertex.shape = &quot;none&quot;, vertex.label = nodes2$media,
     vertex.label.color = V(net2)$color, vertex.label.font = 2,
     vertex.label.cex = .95, edge.color = &quot;gray70&quot;,  edge.width = 2)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-67-1.png" width="672" /></p>
<pre class="r"><code># Using tidygraph
as_tbl_graph(x = links2, directed = TRUE) %&gt;%
  activate(nodes) %&gt;%
  left_join(nodes2, by = c(&quot;name&quot; = &quot;id&quot;)) %&gt;%
  ggraph(layout = &quot;nicely&quot;) +
  geom_edge_link(end_cap = circle(.4,&quot;cm&quot;), 
                 start_cap = circle(0.4, &quot;cm&quot;)) +
  # geom_node&gt;point(aes(shape = type, fill = type, size = type)) +
  geom_node_text(aes(label= media, colour = type), size = 4) +
  
  scale_shape_manual(
    &quot;Type&quot;,
    values = c(22, 21),
    labels = c(&quot;Media&quot;, &quot;Persons&quot;),
    guide = guide_legend(override.aes = list(size = 4))
  ) +
  
  scale_fill_manual(
    &quot;Type&quot;,
    values = c(&quot;dodgerblue&quot;, &quot;orange&quot;),
    labels = c(&quot;Media&quot;, &quot;Persons&quot;)
  ) +
  
  scale_size_manual(values = c(10, 4), guide = &quot;none&quot;) </code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-67-2.png" width="672" /></p>
<ul>
<li>Using images as nodes
You will need the ‘png’ package to do this:</li>
</ul>
<pre class="r"><code># install.packages(&quot;png&quot;)
library(&quot;png&quot;)

img.1 &lt;- readPNG(&quot;./images/news.png&quot;)
img.2 &lt;- readPNG(&quot;./images/user.png&quot;)

V(net2)$raster &lt;- list(img.1, img.2)[V(net2)$type+1]

par(mar = c(3,3,3,3))

plot(net2, vertex.shape = &quot;raster&quot;, vertex.label = NA,
     vertex.size = 16, vertex.size2 = 16, edge.width = 2)


# By the way, you can also add any image you want to any plot. For example, many #network graphs could be improved by a photo of a puppy carrying a basket full of kittens.
img.3 &lt;- readPNG(&quot;./images/puppy.png&quot;)
rasterImage(img.3,  xleft = -1.7, xright = 0, ybottom = -1.2, ytop = 0)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
<pre class="r"><code># The numbers after the image are coordinates for the plot.
# The limits of your plotting area are given in par()$usr</code></pre>
<pre class="r"><code># Using ~~tidygraph~~ visNetwork
# See this cheatsheet:
# system.file(&quot;fontAwesome/Font_Awesome_Cheatsheet.pdf&quot;, package = &quot;visNetwork&quot;)
library(visNetwork)

as_tbl_graph(x = links2, directed = TRUE) %&gt;%
  activate(nodes) %&gt;%
  left_join(nodes2, by = c(&quot;name&quot; = &quot;id&quot;)) %&gt;% 
  
  # visNetwork needs a &quot;group&quot; variable for grouping...
  mutate(group = as.character(type)) %&gt;% 
  visIgraph(.) %&gt;% 
  visGroups(groupname = &quot;FALSE&quot;,shape = &quot;icon&quot;, 
            icon = list(code = &quot;f26c&quot;, size = 75, color = &quot;orange&quot;)) %&gt;% 
  visGroups(groupname = &quot;TRUE&quot;,shape = &quot;icon&quot;, 
            icon = list(code = &quot;f007&quot;, size = 75)) %&gt;% 
  addFontAwesome()</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"nodes":{"id":["s01","s02","s03","s04","s05","s06","s07","s08","s09","s10","U01","U02","U03","U04","U05","U06","U07","U08","U09","U10","U11","U12","U13","U14","U15","U16","U17","U18","U19","U20"],"type":[false,false,false,false,false,false,false,false,false,false,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],"media":["NYT","WaPo","WSJ","USAT","LATimes","CNN","MSNBC","FOX ","ABC","BBC","John","Mary","Paul","Ted","Tom","Kate","Ed","Anna","Dan","Nancy","Sandra","Ronda","Sheila","Jim","Jill","Jo","Brian","Jason","Lisa","Dave"],"media.type":[1,1,1,1,1,2,2,2,2,2,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"media.name":["Newspaper","Newspaper","Newspaper","Newspaper","Newspaper","TV","TV","TV","TV","TV",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"audience.size":[20,25,30,32,20,56,34,60,23,34,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"group":["FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","FALSE","TRUE","TRUE","TRUE","TRUE","TRUE","TRUE","TRUE","TRUE","TRUE","TRUE","TRUE","TRUE","TRUE","TRUE","TRUE","TRUE","TRUE","TRUE","TRUE","TRUE"],"label":["s01","s02","s03","s04","s05","s06","s07","s08","s09","s10","U01","U02","U03","U04","U05","U06","U07","U08","U09","U10","U11","U12","U13","U14","U15","U16","U17","U18","U19","U20"],"x":[0.875794152013906,-0.876534474835432,-0.150160421649664,0.199805582338123,0.143943475246901,-0.273980859015677,-0.561411622189985,-0.590160538019765,-0.566399146614502,0.506180040846123,0.698374177231765,1,0.971551799164517,-0.926598003328571,-1,-0.363318453759271,-0.176772753111752,-0.0810257699540002,0.034281472468183,0.295928423024932,0.294708553196144,0.211167497112309,-0.0589480176550634,-0.408042689921689,-0.630748278059063,-0.611475879477556,-0.433887321062141,-0.718770135310617,-0.594758545363145,-0.729574517089591],"y":[0.353460275919258,-0.820569228824587,-0.639932658374738,-0.213114342013239,0.37162956924343,0.575425528495313,0.804596625594114,0.274229155614842,-0.439372682632045,0.198237365650179,0.278403226858261,0.311953645758364,0.486654675151901,-1,-0.859567165565216,-0.564267238060854,-0.848929541400687,-0.820669932814206,-0.448833241642035,-0.338295609346574,0.116949504055721,0.540355044143214,0.502717747724421,0.751354655676263,1,0.559096033575946,0.432670998788391,0.298949380968368,-0.0865656947211026,-0.642327869895226]},"edges":{"from":["s01","s01","s01","s02","s02","s02","s03","s03","s03","s03","s04","s04","s04","s05","s05","s05","s06","s06","s06","s07","s07","s07","s08","s08","s08","s08","s09","s09","s09","s10","s10"],"to":["U01","U02","U03","U04","U05","U20","U06","U07","U08","U09","U09","U10","U11","U11","U12","U13","U13","U14","U17","U14","U15","U16","U16","U17","U18","U19","U06","U19","U20","U01","U11"],"weight":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false,"arrows":"to"},"physics":{"stabilization":false},"groups":{"FALSE":{"shape":"icon","icon":{"code":"f26c","size":75,"color":"orange"}},"useDefaultGroups":true,"TRUE":{"shape":"icon","icon":{"code":"f007","size":75,"color":"#2B7CE9"}}}},"groups":["FALSE","TRUE"],"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"iconsRedraw":true},"evals":[],"jsHooks":[]}</script>
<p>We can also generate and plot <strong>bipartite projections</strong> for the <strong>two-mode network</strong> : (co-memberships are easy to calculate by multiplying the network matrix by its transposed matrix, or using igraph’s <code>bipartite.projection</code> function)</p>
<pre class="r"><code>net2.bp &lt;- bipartite.projection(net2)

#We can calculate the projections manually as well:
as_incidence_matrix(net2)  %*% t(as_incidence_matrix(net2))</code></pre>
<pre><code>##     s01 s02 s03 s04 s05 s06 s07 s08 s09 s10
## s01   3   0   0   0   0   0   0   0   0   1
## s02   0   3   0   0   0   0   0   0   1   0
## s03   0   0   4   1   0   0   0   0   1   0
## s04   0   0   1   3   1   0   0   0   0   1
## s05   0   0   0   1   3   1   0   0   0   1
## s06   0   0   0   0   1   3   1   1   0   0
## s07   0   0   0   0   0   1   3   1   0   0
## s08   0   0   0   0   0   1   1   4   1   0
## s09   0   1   1   0   0   0   0   1   3   0
## s10   1   0   0   1   1   0   0   0   0   2</code></pre>
<pre class="r"><code>t(as_incidence_matrix(net2)) %*%   as_incidence_matrix(net2)</code></pre>
<pre><code>##     U01 U02 U03 U04 U05 U06 U07 U08 U09 U10 U11 U12 U13 U14 U15 U16 U17 U18 U19
## U01   2   1   1   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0
## U02   1   1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
## U03   1   1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
## U04   0   0   0   1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0
## U05   0   0   0   1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0
## U06   0   0   0   0   0   2   1   1   1   0   0   0   0   0   0   0   0   0   1
## U07   0   0   0   0   0   1   1   1   1   0   0   0   0   0   0   0   0   0   0
## U08   0   0   0   0   0   1   1   1   1   0   0   0   0   0   0   0   0   0   0
## U09   0   0   0   0   0   1   1   1   2   1   1   0   0   0   0   0   0   0   0
## U10   0   0   0   0   0   0   0   0   1   1   1   0   0   0   0   0   0   0   0
## U11   1   0   0   0   0   0   0   0   1   1   3   1   1   0   0   0   0   0   0
## U12   0   0   0   0   0   0   0   0   0   0   1   1   1   0   0   0   0   0   0
## U13   0   0   0   0   0   0   0   0   0   0   1   1   2   1   0   0   1   0   0
## U14   0   0   0   0   0   0   0   0   0   0   0   0   1   2   1   1   1   0   0
## U15   0   0   0   0   0   0   0   0   0   0   0   0   0   1   1   1   0   0   0
## U16   0   0   0   0   0   0   0   0   0   0   0   0   0   1   1   2   1   1   1
## U17   0   0   0   0   0   0   0   0   0   0   0   0   1   1   0   1   2   1   1
## U18   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   1   1   1
## U19   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   1   1   1   2
## U20   0   0   0   1   1   1   0   0   0   0   0   0   0   0   0   0   0   0   1
##     U20
## U01   0
## U02   0
## U03   0
## U04   1
## U05   1
## U06   1
## U07   0
## U08   0
## U09   0
## U10   0
## U11   0
## U12   0
## U13   0
## U14   0
## U15   0
## U16   0
## U17   0
## U18   0
## U19   1
## U20   2</code></pre>
<pre class="r"><code>par(mfrow = c(1, 2))

plot(
  net2.bp$proj1,
  vertex.label.color = &quot;black&quot;,
  vertex.label.dist = 2,
  vertex.label = nodes2$media[!is.na(nodes2$media.type)]
)

plot(
  net2.bp$proj2,
  vertex.label.color = &quot;black&quot;,
  vertex.label.dist = 2,
  vertex.label = nodes2$media[is.na(nodes2$media.type)]
)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
<pre class="r"><code># Using tidygraph
# Calculate projections and add attributes/labels
proj1 &lt;-
  as_incidence_matrix(net2)  %*% t(as_incidence_matrix(net2)) %&gt;%
  as_tbl_graph() %&gt;%
  activate(nodes) %&gt;%
  left_join(., nodes2, by = c(&quot;name&quot; = &quot;id&quot;))
proj2 &lt;-
  t(as_incidence_matrix(net2)) %*%   as_incidence_matrix(net2) %&gt;% as_tbl_graph() %&gt;%
  activate(nodes) %&gt;%
  left_join(., nodes2, by = c(&quot;name&quot; = &quot;id&quot;))


p1 &lt;- proj1 %&gt;%
  ggraph(layout = &quot;graphopt&quot;) +
  geom_edge_link0() +
  geom_node_point(size = 6, colour = &quot;orange&quot;) +
  geom_node_text(aes(label = media), repel = TRUE)

p2 &lt;- proj2 %&gt;%
  ggraph(layout = &quot;graphopt&quot;) +
  geom_edge_link0() +
  geom_node_point(
    aes(colour = media.type),
    size = 6,
    shape  = 15,
    colour = &quot;dodgerblue&quot;
  ) +
  geom_node_text(aes(label = media), repel = TRUE)

p1 + p2</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-71-1.png" width="672" /></p>
</div>
<div id="plotting-multiplex-networks" class="section level2">
<h2>5. Plotting multiplex networks</h2>
<p>In some cases, the networks we want to plot are <strong>multigraphs</strong>: they can have multiple edges connecting the same two nodes. A related concept, <strong>multiplex networks</strong>, contain multiple types of ties – e.g. friendship, romantic, and work relationships between individuals.</p>
<p>In our example network, we also have two tie types: hyperlinks and mentions. One thing we can do is plot each type of tie separately:</p>
<pre class="r"><code>E(net)$width &lt;- 2
plot(
  net,
  edge.color = c(&quot;dark red&quot;, &quot;slategrey&quot;)[(E(net)$type == &quot;hyperlink&quot;) +
                                            1],
  vertex.color = &quot;gray40&quot;,
  layout = layout_in_circle,
  edge.curved = .3
)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
<pre class="r"><code># Another way to delete edges using the minus operator:
net.m &lt;- net - E(net)[E(net)$type == &quot;hyperlink&quot;]
net.h &lt;- net - E(net)[E(net)$type == &quot;mention&quot;]

#Plot the two links separately:
par(mfrow = c(1, 2))

plot(net.h,
     vertex.color = &quot;orange&quot;,
     layout = layout_with_fr,
     main = &quot;Tie: Hyperlink&quot;)
plot(net.m,
     vertex.color = &quot;lightsteelblue2&quot;,
     layout = layout_with_fr,
     main = &quot;Tie: Mention&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-72-2.png" width="672" /></p>
<ul>
<li>Make sure the nodes stay in the same place in both plots:</li>
</ul>
<pre class="r"><code>par(mfrow = c(1, 2), mar = c(1, 1, 4, 1))

l &lt;- layout_with_fr(net)
plot(net.h,
     vertex.color = &quot;orange&quot;,
     layout = l,
     main = &quot;Tie: Hyperlink&quot;)
plot(net.m,
     vertex.color = &quot;lightsteelblue2&quot;,
     layout = l,
     main = &quot;Tie: Mention&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-73-1.png" width="672" /></p>
<pre class="r"><code>#Using tidygraph

layout &lt;- layout_in_circle(net)
p1 &lt;- tbl_graph(nodes, links, directed = TRUE) %&gt;% 
  activate(nodes) %&gt;% 
  mutate(size = centrality_degree()) %&gt;% 
  activate(edges) %&gt;% 
  filter(type == &quot;hyperlink&quot;) %&gt;% 
  
  # reusing the earlier computed layout
  ggraph(layout = layout) +
  geom_edge_arc(strength = 0.05) +
  geom_node_point(aes(size = size), shape = 21, 
                  fill = &quot;orange&quot;) +
  scale_size(range = c(2, 12)) + 
  labs(title = &quot;Tie: Hyperlink&quot;) + 
  theme(aspect.ratio = 1,,
        legend.position = &quot;bottom&quot;)

p2 &lt;- tbl_graph(nodes, links, directed = TRUE) %&gt;% 
  activate(nodes) %&gt;% 
  mutate(size = centrality_degree()) %&gt;% 
  activate(edges) %&gt;% 
  filter(type == &quot;mention&quot;) %&gt;% 
   # reusing the earlier computed layout
  ggraph(layout = layout) +
  geom_edge_arc(strength = 0.05) +
  geom_node_point(aes(size = size), shape = 21, 
                  fill = &quot;lightsteelblue2&quot;) +
  scale_size(range = c(2, 12)) + 
  labs(title = &quot;Tie: Mention&quot;) + 
  theme(aspect.ratio = 1, legend.position = &quot;bottom&quot;)

wrap_plots(p1, p2,guides = &quot;collect&quot;) &amp; 
  # note this &quot;pipe&quot; for patchwork!
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p>
<p>In our example network, we don’t have <strong>node dyads</strong> connected by multiple types of connections (we never have both a ‘hyperlink’ and a ‘mention’ tie between the same two news outlets) – however that could happen.</p>
<p>Note: See the edges between <code>s03</code> and <code>s10</code>…these are in opposite directions. So no dyads.</p>
<pre class="r"><code>layout &lt;- layout_in_circle(net)
tbl_graph(nodes, links, directed = TRUE) %&gt;%  
  activate(nodes) %&gt;% 
  mutate(size = centrality_degree()) %&gt;% 

  # reusing the earlier computed layout
  ggraph(layout = layout) +
  geom_edge_arc(strength = 0.05, aes(colour = type)) +
  geom_node_point(aes(size = size), shape = 21, 
                  fill = &quot;orange&quot;) +
  geom_node_text(aes(label = id), repel = TRUE) +
  scale_size(range = c(2, 12)) + 
  labs(title = &quot;Tie: Hyperlink&quot;) + 
  theme(aspect.ratio = 1,,
        legend.position = &quot;bottom&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
<p>One challenge in visualizing multiplex networks is that multiple edges between the same two nodes may get plotted on top of each other in a way that makes them impossible to distinguish. For example, let us generate a simple multiplex network with two nodes and three ties between them:</p>
<pre class="r"><code>multigtr &lt;- graph(edges = c(1, 2, 1, 2, 1, 2), n = 2)

l &lt;- layout_with_kk(multigtr)

# Let&#39;s just plot the graph:
plot(
  multigtr,
  vertex.color = &quot;lightsteelblue&quot;,
  vertex.frame.color = &quot;white&quot;,
  vertex.size = 40,
  vertex.shape = &quot;circle&quot;,
  vertex.label = NA,
  edge.color = c(&quot;gold&quot;, &quot;tomato&quot;, &quot;yellowgreen&quot;),
  edge.width = 10,
  edge.arrow.size = 5,
  edge.curved = 0.1,
  layout = l
)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-76-1.png" width="672" /></p>
<pre class="r"><code># Using tidygraph
multigtr %&gt;% 
  as_tbl_graph() %&gt;% 
  activate(edges) %&gt;% 
  mutate(edge_col = c(&quot;gold&quot;, &quot;tomato&quot;, &quot;yellowgreen&quot;)) %&gt;% 
ggraph(., layout = l) +
  geom_edge_arc(strength = 0.1, aes(colour = edge_col)) + 
  geom_node_point(size = 4, colour = &quot;lightsteelblue&quot;) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-76-2.png" width="672" /></p>
<p>Because all edges in the graph have the same curvature, they are drawn over each other so that we only see the last one. What we can do is assign each edge a different curvature. One useful function in ‘igraph’ called <code>curve_multiple()</code> can help us here. For a graph G, <code>curve.multiple(G)</code> will generate a curvature for each edge that maximizes visibility.</p>
<pre class="r"><code>plot(
  multigtr,
  vertex.color = &quot;lightsteelblue&quot;,
  vertex.frame.color = &quot;white&quot;,
  vertex.size = 40,
  vertex.shape = &quot;circle&quot;,
  vertex.label = NA,
  edge.color = c(&quot;gold&quot;, &quot;tomato&quot;, &quot;yellowgreen&quot;),
  edge.width = 10,
  edge.arrow.size = 5,
  edge.curved = curve_multiple(multigtr),
  layout = l
)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
<pre class="r"><code>multigtr %&gt;% 
  as_tbl_graph() %&gt;% 
  activate(edges) %&gt;% 
  mutate(edge_col = c(&quot;gold&quot;, &quot;tomato&quot;, &quot;yellowgreen&quot;)) %&gt;% 
ggraph(., layout = l) +
  geom_edge_fan(strength = 0.1, aes(colour = edge_col),width = 2) + 
  geom_node_point(size = 4, colour = &quot;lightsteelblue&quot;) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p>
<p>And that is the end of this reoworked tutorial! Hope you enjoyed it and found it useful!!</p>
</div>
</div>
