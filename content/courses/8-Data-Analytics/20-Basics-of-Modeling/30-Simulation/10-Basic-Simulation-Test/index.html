---
title: 'Simulation Tests'
author: "Arvind Venkatadri"
subtitle: "What is meant by a Simulation Test"
date: "2022-11-25"
view: 2
type: page
weight: 10
summary: ""
output:
  html_document:
    toc_float: true
    theme: united
    toc: true
    code_folding: true
tags:
- Monte Carlo Simulation
- Random Number Generation
- Distributions
image: 
  caption: ""
  focal_point: Smart
external_link: ""
links:
- icon: book
  icon_pack: fa
  name: notes
  url: ""
- icon: file-powerpoint
  icon_pack: fa
  name: slides
  url: ""
- icon: registered
  icon_pack: fa
  name: installation
  url: ""
slides: ""
url_code: ""
url_pdf: ""
url_slides: ""
url_video: ""
---

<script src="{{< blogdown/postref >}}index_files/font-awesome/js/script.js"></script>


<p><img src="https://static.toiimg.com/thumb/msid-87538433,imgsize-178704,width-400,resizemode-4/87538433.jpg" /><!-- --></p>
<div id="introduction-the-lady-who-drank-tea" class="section level2">
<h2>Introduction: The Lady who Drank Tea</h2>
<blockquote>
<p>There is a famous story about a lady who claimed that tea with milk tasted different depending on whether the milk was added to the tea or the tea added to the milk. The story is famous because of the setting in which she made this claim. She was attending a party in Cambridge, England, in the 1920s. Also in attendance were a number of university dons and their wives. The scientists in attendance scoffed at the woman and her claim. What, after all, could be the difference?</p>
<p>All the scientists but one, that is. Rather than simply dismiss the woman’s claim, he proposed that they decide how one should test the claim. The tenor of the conversation changed at this suggestion, and the scientists began to discuss how the claim should be tested. Within a few minutes cups of tea with milk had been prepared and presented to the woman for tasting.</p>
<p>At this point, you may be wondering who the innovative scientist was and what the results of the experiment were. The scientist was R. A. Fisher, who first described this situation as a pedagogical example in his 1925 book on statistical methodology[^1]. Fisher developed statistical methods that are among the most important and widely used methods to this day, and most of his applications were biological.</p>
</blockquote>
<div id="game" class="section level3">
<h3>Game</h3>
<p>Let’s try an experiment. I’ll flip 10 coins. You guess which are heads and which are tails, and we’ll see how you do. Please write down a sequence of “H” or “T”. Comparing with your classmates, we will undoubtedly see that some of you did better and others worse.</p>
<p>What would be your impression of one of you got 9 guesses correct? Is that SKILL or is that something else? What would be your <strong>immediate reaction</strong> and <strong>next move</strong>?</p>
</div>
<div id="analysis" class="section level3">
<h3>Analysis</h3>
<p>Back to the Lady who drank Tea !!</p>
<blockquote>
<p>Let’s suppose we decide to test the lady with ten cups of tea. We’ll flip a coin to decide which way to prepare the cups. If we flip a head, we will pour the milk in first; if tails, we put the tea in first. Then we present the ten cups to the lady and have her state which ones she thinks were prepared each way.</p>
<p>It is easy to give her a score (9 out of 10, or 7 out of 10, or whatever it happens to be). It is trickier to figure out what to do with her score. Even if she is just guessing and has no idea, she could get lucky and get quite a few correct – maybe even all 10. But how likely is that?</p>
<p>Now let’s suppose the lady gets 9 out of 10 correct. That’s not perfect, but it is better than we would expect for someone who was just guessing. On the other hand, it is not impossible to get 9 out of 10 just by guessing.</p>
<p>So here is Fisher’s great idea: <strong>Let’s figure out how hard it is to get 9 out of 10 by guessing</strong>. If it’s not so hard to do, then perhaps that’s just what happened ( that she was guessing ), so we won’t be too impressed with the lady’s tea tasting ability. On the other hand, if it is really unusual to get 9 out of 10 correct by guessing, then we will have some evidence that she must be able to tell something ( and has an unusual Skill).</p>
<p>But how do we figure out how unusual it is to get 9 out of 10 just by guessing? Let’s just flip a bunch of coins and keep track. If the lady is just guessing, she might as well be flipping a coin.</p>
<p>So here’s the plan. We’ll flip 10 coins. We’ll call the heads correct guesses and the tails incorrect guesses.</p>
</blockquote>
<pre><code>## heads
##    0    1    2    3    4    5    6    7    8    9   10 
##    5   92  442 1166 2057 2435 2057 1131  501  103   11</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>So what do we conclude? It is possible that the lady could get 9 or 10 correct just by guessing, but it is not very likely (it only happened in about 3% of our simulations). So one of two things must be true:
• The lady got unusually "lucky”, or
• The lady is not just guessing</p>
</div>
</div>
<div id="commentary" class="section level2">
<h2>Commentary</h2>
<p>First we realize something is <strong>surprising</strong>, and that we have a <strong>question</strong> or <strong>doubt</strong>. This is based on something we see, or measure, a <strong>test statistic</strong>. In our story, it is the <strong>score</strong> of <span class="math inline">\(10/10\)</span> that the Lady was able to achieve about how the Tea was made.</p>
<p>We then <strong>assume</strong> the Lady is guessing <em>and</em> somehow <strong>by chance</strong> able to guess correctly. This would be our….<strong>NULL Hypothesis</strong>. This is our (conservative) <em>belief</em> about the <strong>Real World</strong>.</p>
<p>We then <em>randomly generate</em> many <strong>Parallel Counterfactual Worlds</strong>, where we repeat the experiment many many times, each time calculating the <em>test statistic</em>, under the <em>assumption</em> of the NULL Hypothesis is TRUE.</p>
<p>We see how often our <em>Parallel Worlds</em> can mimic or exceed <em>Real World</em> measurement of the the <em>test statistic</em> by comparison. If this is common (i.e. probability is high) we say we cannot reject the NULL Hypothesis (and the Lady is lucky). If the occurrence is rare, as in our case, we say we have reason to reject the NULL Hypothesis and reason to believe an underlying pattern (and Lady’s ability is beyond <strong>Question</strong> !)</p>
<p>This is the essence of the <strong>Simulation Method</strong> in statistical modelling. Take one more look at the picture from Allen Downey’s blog, below:</p>
<p><img src="images/One-Test.png" /></p>
</div>
<div id="datasets" class="section level2">
<h2>Datasets</h2>
</div>
<div id="workflow-in-orange" class="section level2">
<h2>Workflow in Orange</h2>
</div>
<div id="workflow-in-radiant" class="section level2">
<h2>Workflow in Radiant</h2>
</div>
<div id="workflow-in-r" class="section level2">
<h2>Workflow in R</h2>
<p>In R, the easiest way to perform Simulation Tests is to use a package called <code>mosaic</code>. See <a href="http://www.mosaic-web.org/">Project MOSAIC</a>.</p>
<p>Please download the embedded file linked below and upload into RStudio.Cloud.</p>
<style type="text/css">
/* from https://ianlunn.github.io/Hover/ */
.hvr-sweep-to-left {
  display: inline-block;
  vertical-align: middle;
  -webkit-transform: perspective(1px) translateZ(0);
  transform: perspective(1px) translateZ(0);
  box-shadow: 0 0 1px rgba(0, 0, 0, 0);
  position: relative;
  -webkit-transition-property: color;
  transition-property: color;
  -webkit-transition-duration: 0.3s;
  transition-duration: 0.3s;
}
.hvr-sweep-to-left:before {
  content: "";
  position: absolute;
  z-index: -1;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: #2098D1;
  -webkit-transform: scaleX(0);
  transform: scaleX(0);
  -webkit-transform-origin: 100% 50%;
  transform-origin: 100% 50%;
  -webkit-transition-property: transform;
  transition-property: transform;
  -webkit-transition-duration: 0.3s;
  transition-duration: 0.3s;
  -webkit-transition-timing-function: ease-out;
  transition-timing-function: ease-out;
}
.hvr-sweep-to-left:hover, .hvr-sweep-to-left:focus, .hvr-sweep-to-left:active {
  color: white;
}
.hvr-sweep-to-left:hover:before, .hvr-sweep-to-left:focus:before, .hvr-sweep-to-left:active:before {
  -webkit-transform: scaleX(1);
  transform: scaleX(1);
}

</style>
<a onclick="fetch(&#39;data:text/x-markdown;base64,LS0tDQp0aXRsZTogInNpbXVsYXRpb24iDQphdXRob3I6ICJBcnZpbmQgVmVua2F0YWRyaSINCmRhdGU6ICdgciBTeXMuRGF0ZSgpYCcNCm91dHB1dDogaHRtbF9kb2N1bWVudA0KLS0tDQoNCmBgYHtyIHNldHVwLCBpbmNsdWRlPUZBTFNFfQ0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFKQ0KbGlicmFyeShtb3NhaWMpDQpsaWJyYXJ5KG1vc2FpY0RhdGEpDQpgYGANCg0KIyMgUiBNYXJrZG93bg0KDQpUaGlzIGlzIGFuIFIgTWFya2Rvd24gZG9jdW1lbnQuIE1hcmtkb3duIGlzIGEgc2ltcGxlIGZvcm1hdHRpbmcgc3ludGF4IGZvciBhdXRob3JpbmcgSFRNTCwgUERGLCBhbmQgTVMgV29yZCBkb2N1bWVudHMuIEZvciBtb3JlIGRldGFpbHMgb24gdXNpbmcgUiBNYXJrZG93biBzZWUgPGh0dHA6Ly9ybWFya2Rvd24ucnN0dWRpby5jb20+Lg0KDQpXaGVuIHlvdSBjbGljayB0aGUgKipLbml0KiogYnV0dG9uIGEgZG9jdW1lbnQgd2lsbCBiZSBnZW5lcmF0ZWQgdGhhdCBpbmNsdWRlcyBib3RoIGNvbnRlbnQgYXMgd2VsbCBhcyB0aGUgb3V0cHV0IG9mIGFueSBlbWJlZGRlZCBSIGNvZGUgY2h1bmtzIHdpdGhpbiB0aGUgZG9jdW1lbnQuIFlvdSBjYW4gZW1iZWQgYW4gUiBjb2RlIGNodW5rIGxpa2UgdGhpczoNCg0KYGBge3IgY2Fyc30NCnN1bW1hcnkoY2FycykNCmBgYA0KDQojIyBJbmNsdWRpbmcgUGxvdHMNCg0KWW91IGNhbiBhbHNvIGVtYmVkIHBsb3RzLCBmb3IgZXhhbXBsZToNCg0KYGBge3IgcHJlc3N1cmUsIGVjaG89RkFMU0V9DQpwbG90KHByZXNzdXJlKQ0KYGBgDQoNCk5vdGUgdGhhdCB0aGUgYGVjaG8gPSBGQUxTRWAgcGFyYW1ldGVyIHdhcyBhZGRlZCB0byB0aGUgY29kZSBjaHVuayB0byBwcmV2ZW50IHByaW50aW5nIG9mIHRoZSBSIGNvZGUgdGhhdCBnZW5lcmF0ZWQgdGhlIHBsb3QuDQo=&#39;).then(res =&gt; res.blob()).then(blob =&gt; {&#10;      const downloadURL = window.URL.createObjectURL(blob);&#10;      const a = document.createElement(&#39;a&#39;);&#10;      document.body.appendChild(a);&#10;      a.href = downloadURL;&#10;      a.download = &#39;simulation.Rmd&#39;; a.click();&#10;      window.URL.revokeObjectURL(downloadURL);&#10;      document.body.removeChild(a);&#10;    });">
<button class="btn btn-danger" output_extension=".Rmd"><i class="fa fa-save"></i> Download simulation code in R</button>
</a>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>[^1]. R.A. Fisher. <em>Statistical Methods for Research Workers</em>. Oliver &amp; Boyd, 1925</p>
<ol style="list-style-type: decimal">
<li><p><a href="https://timesofindia.indiatimes.com/sports/cricket/icc-mens-t20-world-cup/in-numbers-virat-kohli-and-his-strange-luck-with-the-coin-toss/articleshow/87538443.cms" class="uri">https://timesofindia.indiatimes.com/sports/cricket/icc-mens-t20-world-cup/in-numbers-virat-kohli-and-his-strange-luck-with-the-coin-toss/articleshow/87538443.cms</a></p></li>
<li><p>D. Salsburg. <em>The Lady Tasting Tea: How statistics revolutionized science in the twentieth century.</em> W.H. Freeman, New York, 2001</p></li>
</ol>
</div>
