---
title: "Chap03Testing_Exer"
author: "Chihara-Hesterberg"
date: "December 2018"
output: html_document
---



<p>##Chapter 3 Introduction to Hypothesis Testing: Permutation Tests
##Exercises</p>
<p>###Exercise 7</p>
<pre class="r"><code>FlightDelays &lt;- read.csv(&quot;http://sites.google.com/site/chiharahesterberg/data2/FlightDelays.csv&quot;)

N&lt;-10^4-1
UA.Delay &lt;- FlightDelays %&gt;% filter(Carrier == &quot;UA&quot;) %&gt;% pull(Delay)
AA.Delay &lt;- FlightDelays %&gt;% filter(Carrier == &quot;AA&quot;) %&gt;% pull(Delay)

observedSumUA &lt;- sum(UA.Delay)
observedmeanUA &lt;- mean(UA.Delay)
observedmeanDiff &lt;- mean(UA.Delay) - mean(AA.Delay)
m &lt;-length(UA.Delay)  #number of UA observations

sumUA&lt;-numeric(N)
meanUA&lt;-numeric(N)
meanDiff&lt;-numeric(N)

set.seed(0)
for (i in 1:N)
{
  index &lt;- sample(4029,  m, replace = FALSE)
  sumUA[i] &lt;- sum(FlightDelays$Delay[index])
  meanUA[i] &lt;- mean(FlightDelays$Delay[index])
  meanDiff[i] &lt;- mean(FlightDelays$Delay[index]) - mean(FlightDelays$Delay[-index])

}

(sum(sumUA &gt;= observedSumUA) + 1)/(N + 1)  #P-value</code></pre>
<pre><code>## [1] 2e-04</code></pre>
<pre class="r"><code>(sum(meanUA &gt;= observedmeanUA) + 1)/(N + 1)  #P-value</code></pre>
<pre><code>## [1] 2e-04</code></pre>
<pre class="r"><code>(sum(meanDiff &gt;= observedmeanDiff) + 1)/(N + 1)  #P-value</code></pre>
<pre><code>## [1] 2e-04</code></pre>
